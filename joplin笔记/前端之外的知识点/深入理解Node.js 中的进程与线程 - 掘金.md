# æ·±å…¥ç†è§£Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹

## å‰è¨€

`è¿›ç¨‹`ä¸`çº¿ç¨‹`æ˜¯ä¸€ä¸ªç¨‹åºå‘˜çš„å¿…çŸ¥æ¦‚å¿µï¼Œé¢è¯•ç»å¸¸è¢«é—®åŠï¼Œä½†æ˜¯ä¸€äº›æ–‡ç« å†…å®¹åªæ˜¯è®²è®²ç†è®ºçŸ¥è¯†ï¼Œå¯èƒ½ä¸€äº›å°ä¼™ä¼´å¹¶æ²¡æœ‰çœŸçš„ç†è§£ï¼Œåœ¨å®é™…å¼€å‘ä¸­åº”ç”¨ä¹Ÿæ¯”è¾ƒå°‘ã€‚æœ¬ç¯‡æ–‡ç« é™¤äº†ä»‹ç»æ¦‚å¿µï¼Œé€šè¿‡Node.js çš„è§’åº¦è®²è§£`è¿›ç¨‹`ä¸`çº¿ç¨‹`ï¼Œå¹¶ä¸”è®²è§£ä¸€äº›åœ¨é¡¹ç›®ä¸­çš„å®æˆ˜çš„åº”ç”¨ï¼Œè®©ä½ ä¸ä»…èƒ½è¿æˆ˜é¢è¯•å®˜è¿˜å¯ä»¥åœ¨å®æˆ˜ä¸­å®Œç¾åº”ç”¨ã€‚

## æ–‡ç« å¯¼è§ˆ

<img width="676" height="269" src="../_resources/16c6cf612c275894_tplv-t2oaga2asx_5a00900f17dc4deaa.webp"/>

ä½œè€…ç®€ä»‹ï¼škoalaï¼Œä¸“æ³¨å®Œæ•´çš„ Node.js æŠ€æœ¯æ ˆåˆ†äº«ï¼Œä» JavaScript åˆ° Node.js,å†åˆ°åç«¯æ•°æ®åº“ï¼Œç¥æ‚¨æˆä¸ºä¼˜ç§€çš„é«˜çº§ Node.js å·¥ç¨‹å¸ˆã€‚ã€ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—ã€‘ä½œè€…ï¼ŒGithub åšå®¢å¼€æºé¡¹ç›® [github.com/koala-codinâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkoala-coding%2FgoodBlog "https://github.com/koala-coding/goodBlog")

## é¢è¯•ä¼šé—®

> Node.jsæ˜¯å•çº¿ç¨‹å—ï¼Ÿ

> Node.js åšè€—æ—¶çš„è®¡ç®—æ—¶å€™ï¼Œå¦‚ä½•é¿å…é˜»å¡ï¼Ÿ

> Node.jså¦‚ä½•å®ç°å¤šè¿›ç¨‹çš„å¼€å¯å’Œå…³é—­ï¼Ÿ

> Node.jså¯ä»¥åˆ›å»ºçº¿ç¨‹å—ï¼Ÿ

> ä½ ä»¬å¼€å‘è¿‡ç¨‹ä¸­å¦‚ä½•å®ç°è¿›ç¨‹å®ˆæŠ¤çš„ï¼Ÿ

> é™¤äº†ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œä½ ä»¬è‡ªå·±æ˜¯å¦å°è£…è¿‡ä¸€ä¸ªå¤šè¿›ç¨‹æ¶æ„?

## è¿›ç¨‹

è¿›ç¨‹`Process`æ˜¯è®¡ç®—æœºä¸­çš„ç¨‹åºå…³äºæŸæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æ„çš„åŸºç¡€ï¼Œè¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨ï¼ˆæ¥è‡ªç™¾ç§‘ï¼‰ã€‚è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæœåŠ¡ã€è¿è¡Œä¸€ä¸ªå®ä¾‹ï¼Œå°±æ˜¯å¼€ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¾‹å¦‚ Java é‡Œçš„ JVM æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ŒNode.js é‡Œé€šè¿‡ `node app.js` å¼€å¯ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œå¤šè¿›ç¨‹å°±æ˜¯è¿›ç¨‹çš„å¤åˆ¶ï¼ˆforkï¼‰ï¼Œfork å‡ºæ¥çš„æ¯ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹ç©ºé—´åœ°å€ã€æ•°æ®æ ˆï¼Œä¸€ä¸ªè¿›ç¨‹æ— æ³•è®¿é—®å¦å¤–ä¸€ä¸ªè¿›ç¨‹é‡Œå®šä¹‰çš„å˜é‡ã€æ•°æ®ç»“æ„ï¼Œåªæœ‰å»ºç«‹äº† IPC é€šä¿¡ï¼Œè¿›ç¨‹ä¹‹é—´æ‰å¯æ•°æ®å…±äº«ã€‚

- Node.jså¼€å¯æœåŠ¡è¿›ç¨‹ä¾‹å­

```
const http = require('http');

const server = http.createServer();
server.listen(3000,()=>{
    process.title='ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—æµ‹è¯•è¿›ç¨‹';
    console.log('è¿›ç¨‹id',process.pid)
})
å¤åˆ¶ä»£ç 
```

è¿è¡Œä¸Šé¢ä»£ç åï¼Œä»¥ä¸‹ä¸º Mac ç³»ç»Ÿè‡ªå¸¦çš„ç›‘æ§å·¥å…· â€œæ´»åŠ¨ç›‘è§†å™¨â€ æ‰€å±•ç¤ºçš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšå¼€å¯çš„ Nodejs è¿›ç¨‹ 7663

<img width="676" height="568" src="../_resources/16c4dc0ca13fec40_tplv-t2oaga2asx_77f79cfdf78a4d069.webp"/>

## çº¿ç¨‹

çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ¸…æ¥šçº¿ç¨‹æ˜¯éš¶å±äºè¿›ç¨‹çš„ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¹‹ä¸­ã€‚**ä¸€ä¸ªçº¿ç¨‹åªèƒ½éš¶å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹çš„**ã€‚

### å•çº¿ç¨‹

**å•çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹åªå¼€ä¸€ä¸ªçº¿ç¨‹**

Javascript å°±æ˜¯å±äºå•çº¿ç¨‹ï¼Œç¨‹åºé¡ºåºæ‰§è¡Œ(è¿™é‡Œæš‚ä¸”ä¸æJSå¼‚æ­¥)ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹é˜Ÿåˆ—ï¼Œå‰é¢ä¸€ä¸ªæ‰§è¡Œå®Œä¹‹åï¼Œåé¢æ‰å¯ä»¥æ‰§è¡Œï¼Œå½“ä½ åœ¨ä½¿ç”¨å•çº¿ç¨‹è¯­è¨€ç¼–ç æ—¶åˆ‡å‹¿æœ‰è¿‡å¤šè€—æ—¶çš„åŒæ­¥æ“ä½œï¼Œå¦åˆ™çº¿ç¨‹ä¼šé€ æˆé˜»å¡ï¼Œå¯¼è‡´åç»­å“åº”æ— æ³•å¤„ç†ã€‚ä½ å¦‚æœé‡‡ç”¨ Javascript è¿›è¡Œç¼–ç æ—¶å€™ï¼Œè¯·å°½å¯èƒ½çš„åˆ©ç”¨Javascriptå¼‚æ­¥æ“ä½œçš„ç‰¹æ€§ã€‚

#### ç»å…¸è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡çš„ä¾‹å­

```
const http = require('http');
const longComputation = () => {
  let sum = 0;
  for (let i = 0; i < 1e10; i++) {
    sum += i;
  };
  return sum;
};
const server = http.createServer();
server.on('request', (req, res) => {
  if (req.url === '/compute') {
    console.info('è®¡ç®—å¼€å§‹',new Date());
    const sum = longComputation();
    console.info('è®¡ç®—ç»“æŸ',new Date());
    return res.end(`Sum is ${sum}`);
  } else {
    res.end('Ok')
  }
});

server.listen(3000);
//æ‰“å°ç»“æœ
//è®¡ç®—å¼€å§‹ 2019-07-28T07:08:49.849Z
//è®¡ç®—ç»“æŸ 2019-07-28T07:09:04.522Z
å¤åˆ¶ä»£ç 
```

æŸ¥çœ‹æ‰“å°ç»“æœï¼Œå½“æˆ‘ä»¬è°ƒç”¨`127.0.0.1:3000/compute` çš„æ—¶å€™ï¼Œå¦‚æœæƒ³è¦è°ƒç”¨å…¶ä»–çš„è·¯ç”±åœ°å€æ¯”å¦‚127.0.0.1/å¤§çº¦éœ€è¦15ç§’æ—¶é—´ï¼Œä¹Ÿå¯ä»¥è¯´ä¸€ä¸ªç”¨æˆ·è¯·æ±‚å®Œç¬¬ä¸€ä¸ª`compute`æ¥å£åéœ€è¦ç­‰å¾…15ç§’ï¼Œè¿™å¯¹äºç”¨æˆ·æ¥è¯´æ˜¯æå…¶ä¸å‹å¥½çš„ã€‚ä¸‹æ–‡æˆ‘ä¼šé€šè¿‡åˆ›å»ºå¤šè¿›ç¨‹çš„æ–¹å¼`child_process.fork` å’Œ`cluster` æ¥è§£å†³è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

#### å•çº¿ç¨‹çš„ä¸€äº›è¯´æ˜

- Node.js è™½ç„¶æ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œä½†æ˜¯å…¶åŸºäºäº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥éé˜»å¡æ¨¡å¼ï¼Œå¯ä»¥åº”ç”¨äºé«˜å¹¶å‘åœºæ™¯ï¼Œé¿å…äº†çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¹‹é—´ä¸Šä¸‹æ–‡åˆ‡æ¢æ‰€äº§ç”Ÿçš„èµ„æºå¼€é”€ã€‚
- å½“ä½ çš„é¡¹ç›®ä¸­éœ€è¦æœ‰å¤§é‡è®¡ç®—ï¼ŒCPU è€—æ—¶çš„æ“ä½œæ—¶å€™ï¼Œè¦æ³¨æ„è€ƒè™‘å¼€å¯å¤šè¿›ç¨‹æ¥å®Œæˆäº†ã€‚
- Node.js å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨çš„å¥å£®æ€§å€¼å¾—è€ƒéªŒï¼Œå°¤å…¶æ˜¯é”™è¯¯çš„å¼‚å¸¸æŠ›å‡ºï¼Œä»¥åŠè¿›ç¨‹å®ˆæŠ¤æ˜¯å¿…é¡»è¦åšçš„ã€‚
- å•çº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸CPUï¼Œä½†æ˜¯åæ¥Node.js æä¾›çš„APIä»¥åŠä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·ç›¸åº”éƒ½å¾—åˆ°äº†è§£å†³ï¼Œæ–‡ç« åé¢éƒ½ä¼šè®²åˆ°ã€‚

## Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹

Node.js æ˜¯ Javascript åœ¨æœåŠ¡ç«¯çš„è¿è¡Œç¯å¢ƒï¼Œæ„å»ºåœ¨ chrome çš„ V8 å¼•æ“ä¹‹ä¸Šï¼ŒåŸºäºäº‹ä»¶é©±åŠ¨ã€éé˜»å¡I/Oæ¨¡å‹ï¼Œå……åˆ†åˆ©ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„å¼‚æ­¥ I/O è¿›è¡Œå¤šä»»åŠ¡çš„æ‰§è¡Œï¼Œé€‚åˆäº I/O å¯†é›†å‹çš„åº”ç”¨åœºæ™¯ï¼Œå› ä¸ºå¼‚æ­¥ï¼Œç¨‹åºæ— éœ€é˜»å¡ç­‰å¾…ç»“æœè¿”å›ï¼Œè€Œæ˜¯åŸºäºå›è°ƒé€šçŸ¥çš„æœºåˆ¶ï¼ŒåŸæœ¬åŒæ­¥æ¨¡å¼ç­‰å¾…çš„æ—¶é—´ï¼Œåˆ™å¯ä»¥ç”¨æ¥å¤„ç†å…¶å®ƒä»»åŠ¡ï¼Œ

> ç§‘æ™®ï¼šåœ¨ Web æœåŠ¡å™¨æ–¹é¢ï¼Œè‘—åçš„ Nginx ä¹Ÿæ˜¯é‡‡ç”¨æ­¤æ¨¡å¼ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰ï¼Œé¿å…äº†å¤šçº¿ç¨‹çš„çº¿ç¨‹åˆ›å»ºã€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼ŒNginx é‡‡ç”¨ C è¯­è¨€è¿›è¡Œç¼–å†™ï¼Œä¸»è¦ç”¨æ¥åšé«˜æ€§èƒ½çš„ Web æœåŠ¡å™¨ï¼Œä¸é€‚åˆåšä¸šåŠ¡ã€‚

Webä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¦‚æœä½ æœ‰é«˜å¹¶å‘åº”ç”¨åœºæ™¯é‚£ä¹ˆ Node.js ä¼šæ˜¯ä½ ä¸é”™çš„é€‰æ‹©ã€‚

åœ¨å•æ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šæˆ‘ä»¬é‡‡ç”¨ å•è¿›ç¨‹ + å•çº¿ç¨‹ çš„æ¨¡å¼æ¥å¼€å‘ã€‚åœ¨å¤šæ ¸ CPU ç³»ç»Ÿä¹‹ä¸Šï¼Œå¯ä»¥é€šè¿‡ `child_process.fork` å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼ˆNode.js åœ¨ v0.8 ç‰ˆæœ¬ä¹‹åæ–°å¢äº†Cluster æ¥å®ç°å¤šè¿›ç¨‹æ¶æ„ï¼‰ ï¼Œå³ å¤šè¿›ç¨‹ + å•çº¿ç¨‹ æ¨¡å¼ã€‚æ³¨æ„ï¼šå¼€å¯å¤šè¿›ç¨‹ä¸æ˜¯ä¸ºäº†è§£å†³é«˜å¹¶å‘ï¼Œä¸»è¦æ˜¯è§£å†³äº†å•è¿›ç¨‹æ¨¡å¼ä¸‹ Node.js CPU åˆ©ç”¨ç‡ä¸è¶³çš„æƒ…å†µï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPU çš„æ€§èƒ½ã€‚

### Node.js ä¸­çš„è¿›ç¨‹

#### process æ¨¡å—

Node.js ä¸­çš„è¿›ç¨‹ Process æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ— éœ€ require ç›´æ¥ä½¿ç”¨ï¼Œç»™æˆ‘ä»¬æä¾›äº†å½“å‰è¿›ç¨‹ä¸­çš„ç›¸å…³ä¿¡æ¯ã€‚å®˜æ–¹æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„è¯´æ˜ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥äº²è‡ªå®è·µä¸‹ Process æ–‡æ¡£ã€‚

- `process.env`ï¼šç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚é€šè¿‡ `process.env.NODE_ENV` è·å–ä¸åŒç¯å¢ƒé¡¹ç›®é…ç½®ä¿¡æ¯
- `process.nextTick`ï¼šè¿™ä¸ªåœ¨è°ˆåŠ `Event Loop` æ—¶ç»å¸¸ä¸ºä¼šæåˆ°
- `process.pid`ï¼šè·å–å½“å‰è¿›ç¨‹id
- `process.ppid`ï¼šå½“å‰è¿›ç¨‹å¯¹åº”çš„çˆ¶è¿›ç¨‹
- `process.cwd()`ï¼šè·å–å½“å‰è¿›ç¨‹å·¥ä½œç›®å½•ï¼Œ
- `process.platform`ï¼šè·å–å½“å‰è¿›ç¨‹è¿è¡Œçš„æ“ä½œç³»ç»Ÿå¹³å°
- `process.uptime()`ï¼šå½“å‰è¿›ç¨‹å·²è¿è¡Œæ—¶é—´ï¼Œä¾‹å¦‚ï¼špm2 å®ˆæŠ¤è¿›ç¨‹çš„ uptime å€¼
- è¿›ç¨‹äº‹ä»¶ï¼š`process.on(â€˜uncaughtExceptionâ€™, cb)` æ•è·å¼‚å¸¸ä¿¡æ¯ã€`process.on(â€˜exitâ€™, cbï¼‰`è¿›ç¨‹æ¨å‡ºç›‘å¬
- ä¸‰ä¸ªæ ‡å‡†æµï¼š`process.stdout` æ ‡å‡†è¾“å‡ºã€`process.stdin` æ ‡å‡†è¾“å…¥ã€`process.stderr` æ ‡å‡†é”™è¯¯è¾“å‡º
- `process.title` æŒ‡å®šè¿›ç¨‹åç§°ï¼Œæœ‰çš„æ—¶å€™éœ€è¦ç»™è¿›ç¨‹æŒ‡å®šä¸€ä¸ªåç§°

ä»¥ä¸Šä»…åˆ—ä¸¾äº†éƒ¨åˆ†å¸¸ç”¨åˆ°åŠŸèƒ½ç‚¹ï¼Œé™¤äº† Process ä¹‹å¤– Node.js è¿˜æä¾›äº† child_process æ¨¡å—ç”¨æ¥å¯¹å­è¿›ç¨‹è¿›è¡Œæ“ä½œï¼Œåœ¨ä¸‹æ–‡ Nodejsè¿›ç¨‹åˆ›å»ºä¼šç»§ç»­è®²è¿°ã€‚

#### Node.js è¿›ç¨‹åˆ›å»º

è¿›ç¨‹åˆ›å»ºæœ‰å¤šç§æ–¹å¼ï¼Œæœ¬ç¯‡æ–‡ç« ä»¥child_processæ¨¡å—å’Œclusteræ¨¡å—è¿›è¡Œè®²è§£ã€‚

##### child_processæ¨¡å—

child_process æ˜¯ Node.js çš„å†…ç½®æ¨¡å—ï¼Œå®˜ç½‘åœ°å€ï¼š

> child_process å®˜ç½‘åœ°å€ï¼š[nodejs.cn/api/child_pâ€¦](https://link.juejin.cn?target=http%3A%2F%2Fnodejs.cn%2Fapi%2Fchild_process.html%23child_process_child_process "http://nodejs.cn/api/child_process.html#child_process_child_process")

å‡ ä¸ªå¸¸ç”¨å‡½æ•°ï¼š å››ç§æ–¹å¼

- `child_process.spawn()`ï¼šé€‚ç”¨äºè¿”å›å¤§é‡æ•°æ®ï¼Œä¾‹å¦‚å›¾åƒå¤„ç†ï¼ŒäºŒè¿›åˆ¶æ•°æ®å¤„ç†ã€‚
- `child_process.exec()`ï¼šé€‚ç”¨äºå°é‡æ•°æ®ï¼ŒmaxBuffer é»˜è®¤å€¼ä¸º 200 * 1024 è¶…å‡ºè¿™ä¸ªé»˜è®¤å€¼å°†ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œæ•°æ®é‡è¿‡å¤§å¯é‡‡ç”¨ spawnã€‚
- `child_process.execFile()`ï¼šç±»ä¼¼ `child_process.exec()`ï¼ŒåŒºåˆ«æ˜¯ä¸èƒ½é€šè¿‡ shell æ¥æ‰§è¡Œï¼Œä¸æ”¯æŒåƒ I/O é‡å®šå‘å’Œæ–‡ä»¶æŸ¥æ‰¾è¿™æ ·çš„è¡Œä¸º
- `child_process.fork()`ï¼š è¡ç”Ÿæ–°çš„è¿›ç¨‹ï¼Œè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ V8 å®ä¾‹ã€å†…å­˜ï¼Œç³»ç»Ÿèµ„æºæ˜¯æœ‰é™çš„ï¼Œä¸å»ºè®®è¡ç”Ÿå¤ªå¤šçš„å­è¿›ç¨‹å‡ºæ¥ï¼Œé€šé•¿æ ¹æ®ç³»ç»Ÿ** CPU æ ¸å¿ƒæ•°**è®¾ç½®ã€‚

> CPU æ ¸å¿ƒæ•°è¿™é‡Œç‰¹åˆ«è¯´æ˜ä¸‹ï¼Œfork ç¡®å®å¯ä»¥å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯å¹¶ä¸å»ºè®®è¡ç”Ÿå‡ºæ¥å¤ªå¤šçš„è¿›ç¨‹ï¼Œcpuæ ¸å¿ƒæ•°çš„è·å–æ–¹å¼`const cpus = require('os').cpus();`,è¿™é‡Œ cpus è¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼ŒåŒ…å«æ‰€å®‰è£…çš„æ¯ä¸ª CPU/å†…æ ¸çš„ä¿¡æ¯ï¼ŒäºŒè€…æ€»å’Œçš„æ•°ç»„å“¦ã€‚å‡è®¾ä¸»æœºè£…æœ‰ä¸¤ä¸ªcpuï¼Œæ¯ä¸ªcpuæœ‰4ä¸ªæ ¸ï¼Œé‚£ä¹ˆæ€»æ ¸æ•°å°±æ˜¯8ã€‚

###### forkå¼€å¯å­è¿›ç¨‹ Demo

forkå¼€å¯å­è¿›ç¨‹è§£å†³æ–‡ç« èµ·åˆçš„è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡ã€‚ åœ¨è¿›è¡Œ compute è®¡ç®—æ—¶åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹è®¡ç®—å®Œæˆé€šè¿‡ `send` æ–¹æ³•å°†ç»“æœå‘é€ç»™ä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹é€šè¿‡ `message` ç›‘å¬åˆ°ä¿¡æ¯åå¤„ç†å¹¶é€€å‡ºã€‚

> fork_app.js

```
const http = require('http');
const fork = require('child_process').fork;

const server = http.createServer((req, res) => {
    if(req.url == '/compute'){
        const compute = fork('./fork_compute.js');
        compute.send('å¼€å¯ä¸€ä¸ªæ–°çš„å­è¿›ç¨‹');

        // å½“ä¸€ä¸ªå­è¿›ç¨‹ä½¿ç”¨ process.send() å‘é€æ¶ˆæ¯æ—¶ä¼šè§¦å‘ 'message' äº‹ä»¶
        compute.on('message', sum => {
            res.end(`Sum is ${sum}`);
            compute.kill();
        });

        // å­è¿›ç¨‹ç›‘å¬åˆ°ä¸€äº›é”™è¯¯æ¶ˆæ¯é€€å‡º
        compute.on('close', (code, signal) => {
            console.log(`æ”¶åˆ°closeäº‹ä»¶ï¼Œå­è¿›ç¨‹æ”¶åˆ°ä¿¡å· ${signal} è€Œç»ˆæ­¢ï¼Œé€€å‡ºç  ${code}`);
            compute.kill();
        })
    }else{
        res.end(`ok`);
    }
});
server.listen(3000, 127.0.0.1, () => {
    console.log(`server started at http://${127.0.0.1}:${3000}`);
});
å¤åˆ¶ä»£ç 
```

> fork_compute.js

é’ˆå¯¹æ–‡åˆéœ€è¦è¿›è¡Œè®¡ç®—çš„çš„ä¾‹å­æˆ‘ä»¬åˆ›å»ºå­è¿›ç¨‹æ‹†åˆ†å‡ºæ¥å•ç‹¬è¿›è¡Œè¿ç®—ã€‚

```
const computation = () => {
    let sum = 0;
    console.info('è®¡ç®—å¼€å§‹');
    console.time('è®¡ç®—è€—æ—¶');

    for (let i = 0; i < 1e10; i++) {
        sum += i
    };

    console.info('è®¡ç®—ç»“æŸ');
    console.timeEnd('è®¡ç®—è€—æ—¶');
    return sum;
};

process.on('message', msg => {
    console.log(msg, 'process.pid', process.pid); // å­è¿›ç¨‹id
    const sum = computation();

    // å¦‚æœNode.jsè¿›ç¨‹æ˜¯é€šè¿‡è¿›ç¨‹é—´é€šä¿¡äº§ç”Ÿçš„ï¼Œé‚£ä¹ˆï¼Œprocess.send()æ–¹æ³•å¯ä»¥ç”¨æ¥ç»™çˆ¶è¿›ç¨‹å‘é€æ¶ˆæ¯
    process.send(sum);
})
å¤åˆ¶ä»£ç 
```

##### clusteræ¨¡å—

cluster å¼€å¯å­è¿›ç¨‹Demo

```
const http = require('http');
const numCPUs = require('os').cpus().length;
const cluster = require('cluster');
if(cluster.isMaster){
    console.log('Master proces id is',process.pid);
    // fork workers
    for(let i= 0;i<numCPUs;i++){
        cluster.fork();
    }
    cluster.on('exit',function(worker,code,signal){
        console.log('worker process died,id',worker.process.pid)
    })
}else{
    // Workerå¯ä»¥å…±äº«åŒä¸€ä¸ªTCPè¿æ¥
    // è¿™é‡Œæ˜¯ä¸€ä¸ªhttpæœåŠ¡å™¨
    http.createServer(function(req,res){
        res.writeHead(200);
        res.end('hello word');
    }).listen(8000);

}
å¤åˆ¶ä»£ç 
```

###### clusteråŸç†åˆ†æ

![](../_resources/16c5658b2e97e9b2_tplv-t2oaga2asx_3c12f5c04bf74f018.webp)

clusteræ¨¡å—è°ƒç”¨forkæ–¹æ³•æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œè¯¥æ–¹æ³•ä¸child_processä¸­çš„forkæ˜¯åŒä¸€ä¸ªæ–¹æ³•ã€‚ clusteræ¨¡å—é‡‡ç”¨çš„æ˜¯ç»å…¸çš„ä¸»ä»æ¨¡å‹ï¼ŒClusterä¼šåˆ›å»ºä¸€ä¸ªmasterï¼Œç„¶åæ ¹æ®ä½ æŒ‡å®šçš„æ•°é‡å¤åˆ¶å‡ºå¤šä¸ªå­è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨`cluster.isMaster`å±æ€§åˆ¤æ–­å½“å‰è¿›ç¨‹æ˜¯masterè¿˜æ˜¯worker(å·¥ä½œè¿›ç¨‹)ã€‚ç”±masterè¿›ç¨‹æ¥ç®¡ç†æ‰€æœ‰çš„å­è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸è´Ÿè´£å…·ä½“çš„ä»»åŠ¡å¤„ç†ï¼Œä¸»è¦å·¥ä½œæ˜¯è´Ÿè´£è°ƒåº¦å’Œç®¡ç†ã€‚

clusteræ¨¡å—ä½¿ç”¨å†…ç½®çš„è´Ÿè½½å‡è¡¡æ¥æ›´å¥½åœ°å¤„ç†çº¿ç¨‹ä¹‹é—´çš„å‹åŠ›ï¼Œè¯¥è´Ÿè½½å‡è¡¡ä½¿ç”¨äº†`Round-robin`ç®—æ³•ï¼ˆä¹Ÿè¢«ç§°ä¹‹ä¸ºå¾ªç¯ç®—æ³•ï¼‰ã€‚å½“ä½¿ç”¨Round-robinè°ƒåº¦ç­–ç•¥æ—¶ï¼Œmaster accepts()æ‰€æœ‰ä¼ å…¥çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†ç›¸åº”çš„TCPè¯·æ±‚å¤„ç†å‘é€ç»™é€‰ä¸­çš„å·¥ä½œè¿›ç¨‹ï¼ˆè¯¥æ–¹å¼ä»ç„¶é€šè¿‡IPCæ¥è¿›è¡Œé€šä¿¡ï¼‰ã€‚

å¼€å¯å¤šè¿›ç¨‹æ—¶å€™ç«¯å£ç–‘é—®è®²è§£ï¼šå¦‚æœå¤šä¸ªNodeè¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£æ—¶ä¼šå‡ºç° `Error:listen EADDRIUNS`çš„é”™è¯¯ï¼Œè€Œclusteræ¨¡å—ä¸ºä»€ä¹ˆå¯ä»¥è®©å¤šä¸ªå­è¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£å‘¢?åŸå› æ˜¯masterè¿›ç¨‹å†…éƒ¨å¯åŠ¨äº†ä¸€ä¸ªTCPæœåŠ¡å™¨ï¼Œè€ŒçœŸæ­£ç›‘å¬ç«¯å£çš„åªæœ‰è¿™ä¸ªæœåŠ¡å™¨ï¼Œå½“æ¥è‡ªå‰ç«¯çš„è¯·æ±‚è§¦å‘æœåŠ¡å™¨çš„connectionäº‹ä»¶åï¼Œmasterä¼šå°†å¯¹åº”çš„socketå…·æŸ„å‘é€ç»™å­è¿›ç¨‹ã€‚

##### child_process æ¨¡å—ä¸cluster æ¨¡å—æ€»ç»“

æ— è®ºæ˜¯ child_process æ¨¡å—è¿˜æ˜¯ cluster æ¨¡å—ï¼Œä¸ºäº†è§£å†³ Node.js å®ä¾‹å•çº¿ç¨‹è¿è¡Œï¼Œæ— æ³•åˆ©ç”¨å¤šæ ¸ CPU çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚æ ¸å¿ƒå°±æ˜¯**çˆ¶è¿›ç¨‹ï¼ˆå³ master è¿›ç¨‹ï¼‰è´Ÿè´£ç›‘å¬ç«¯å£ï¼Œæ¥æ”¶åˆ°æ–°çš„è¯·æ±‚åå°†å…¶åˆ†å‘ç»™ä¸‹é¢çš„ worker è¿›ç¨‹**ã€‚

clusteræ¨¡å—çš„ä¸€ä¸ªå¼Šç«¯ï¼š

![](../_resources/16c565aaeb065b4a_tplv-t2oaga2asx_4e7df5b7899841c1b.webp)

![](../_resources/16d04aa5bbe66349_tplv-t2oaga2asx_73f586f660b9478b9.webp)

clusterå†…éƒ¨éšæ—¶çš„æ„å»ºTCPæœåŠ¡å™¨çš„æ–¹å¼æ¥è¯´å¯¹ä½¿ç”¨è€…ç¡®å®ç®€å•å’Œé€æ˜äº†å¾ˆå¤šï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ— æ³•åƒä½¿ç”¨child\_processé‚£æ ·çµæ´»ï¼Œå› ä¸ºä¸€ç›´ä¸»è¿›ç¨‹åªèƒ½ç®¡ç†ä¸€ç»„ç›¸åŒçš„å·¥ä½œè¿›ç¨‹ï¼Œè€Œè‡ªè¡Œé€šè¿‡child\_processæ¥åˆ›å»ºå·¥ä½œè¿›ç¨‹ï¼Œä¸€ä¸ªä¸»è¿›ç¨‹å¯ä»¥æ§åˆ¶å¤šç»„è¿›ç¨‹ã€‚åŸå› æ˜¯child_processæ“ä½œå­è¿›ç¨‹æ—¶ï¼Œå¯ä»¥éšå¼çš„åˆ›å»ºå¤šä¸ªTCPæœåŠ¡å™¨ï¼Œå¯¹æ¯”ä¸Šé¢çš„ä¸¤å¹…å›¾åº”è¯¥èƒ½ç†è§£æˆ‘è¯´çš„å†…å®¹ã€‚

#### Node.jsè¿›ç¨‹é€šä¿¡åŸç†

å‰é¢è®²è§£çš„æ— è®ºæ˜¯child_processæ¨¡å—ï¼Œè¿˜æ˜¯clusteræ¨¡å—ï¼Œéƒ½éœ€è¦ä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚é€šè¿‡fork()æˆ–è€…å…¶ä»–APIï¼Œåˆ›å»ºäº†å­è¿›ç¨‹ä¹‹åï¼Œä¸ºäº†å®ç°çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œçˆ¶å­è¿›ç¨‹ä¹‹é—´æ‰èƒ½é€šè¿‡messageå’Œsend()ä¼ é€’ä¿¡æ¯ã€‚

IPCè¿™ä¸ªè¯æˆ‘æƒ³å¤§å®¶å¹¶ä¸é™Œç”Ÿï¼Œä¸ç®¡é‚£ä¸€å¼ å¼€å‘è¯­è¨€åªè¦æåˆ°è¿›ç¨‹é€šä¿¡ï¼Œéƒ½ä¼šæåˆ°å®ƒã€‚IPCçš„å…¨ç§°æ˜¯Inter-Process Communication,å³è¿›ç¨‹é—´é€šä¿¡ã€‚å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è®©ä¸åŒçš„è¿›ç¨‹èƒ½å¤Ÿäº’ç›¸è®¿é—®èµ„æºå¹¶è¿›è¡Œåè°ƒå·¥ä½œã€‚å®ç°è¿›ç¨‹é—´é€šä¿¡çš„æŠ€æœ¯æœ‰å¾ˆå¤šï¼Œå¦‚å‘½åç®¡é“ï¼ŒåŒ¿åç®¡é“ï¼Œsocketï¼Œä¿¡å·é‡ï¼Œå…±äº«å†…å­˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚Nodeä¸­å®ç°IPCé€šé“æ˜¯ä¾èµ–äºlibuvã€‚windowsä¸‹ç”±å‘½åç®¡é“(name pipe)å®ç°ï¼Œ*nixç³»ç»Ÿåˆ™é‡‡ç”¨Unix Domain Socketå®ç°ã€‚è¡¨ç°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„messageäº‹ä»¶å’Œsend()æ–¹æ³•ï¼Œæ¥å£ååˆ†ç®€æ´å’Œæ¶ˆæ¯åŒ–ã€‚

IPCåˆ›å»ºå’Œå®ç°ç¤ºæ„å›¾

![](../_resources/16c5b379ad12199e_tplv-t2oaga2asx_b41a6ad06e7842cda.webp)

IPCé€šä¿¡ç®¡é“æ˜¯å¦‚ä½•åˆ›å»ºçš„

<img width="676" height="478" src="../_resources/16c5b3812e3bb7d9_tplv-t2oaga2asx_416ca372e536402e8.webp"/>

çˆ¶è¿›ç¨‹åœ¨å®é™…åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰ï¼Œä¼šåˆ›å»º`IPCé€šé“`å¹¶ç›‘å¬å®ƒï¼Œç„¶åæ‰`çœŸæ­£çš„`åˆ›å»ºå‡º`å­è¿›ç¨‹`ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šé€šè¿‡ç¯å¢ƒå˜é‡ï¼ˆNODE\_CHANNEL\_FDï¼‰å‘Šè¯‰å­è¿›ç¨‹è¿™ä¸ªIPCé€šé“çš„æ–‡ä»¶æè¿°ç¬¦ã€‚å­è¿›ç¨‹åœ¨å¯åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ–‡ä»¶æè¿°ç¬¦å»è¿æ¥è¿™ä¸ªå·²å­˜åœ¨çš„IPCé€šé“ï¼Œä»è€Œå®Œæˆçˆ¶å­è¿›ç¨‹ä¹‹é—´çš„è¿æ¥ã€‚

#### Node.jså¥æŸ„ä¼ é€’

è®²å¥æŸ„ä¹‹å‰ï¼Œå…ˆæƒ³ä¸€ä¸ªé—®é¢˜ï¼Œsendå¥æŸ„å‘é€çš„æ—¶å€™ï¼ŒçœŸçš„æ˜¯å°†æœåŠ¡å™¨å¯¹è±¡å‘é€ç»™äº†å­è¿›ç¨‹ï¼Ÿ

##### å­è¿›ç¨‹å¯¹è±¡send()æ–¹æ³•å¯ä»¥å‘é€çš„å¥æŸ„ç±»å‹

- net.Socket TCPå¥—æ¥å­—
- net.Server TCPæœåŠ¡å™¨ï¼Œä»»æ„å»ºç«‹åœ¨TCPæœåŠ¡ä¸Šçš„åº”ç”¨å±‚æœåŠ¡éƒ½å¯ä»¥äº«å—å®ƒå¸¦æ¥çš„å¥½å¤„
- net.Native C++å±‚é¢çš„TCPå¥—æ¥å­—æˆ–IPCç®¡é“
- dgram.Socket UDPå¥—æ¥å­—
- dgram.Native C++å±‚é¢çš„UDPå¥—æ¥å­—

##### sendå¥æŸ„å‘é€åŸç†åˆ†æ

ç»“åˆå¥æŸ„çš„å‘é€ä¸è¿˜åŸç¤ºæ„å›¾æ›´å®¹æ˜“ç†è§£ã€‚

<img width="676" height="404" src="../_resources/16c5b52b15d87bbe_tplv-t2oaga2asx_9d93fcdb325743328.webp"/>

`send()`æ–¹æ³•åœ¨å°†æ¶ˆæ¯å‘é€åˆ°IPCç®¡é“å‰ï¼Œå®é™…å°†æ¶ˆæ¯ç»„è£…æˆäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå‚æ•°æ˜¯hadlerï¼Œå¦ä¸€ä¸ªæ˜¯messageã€‚messageå‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š

```
{
    cmd:'NODE_HANDLE',
    type:'net.Server',
    msg:message
}
å¤åˆ¶ä»£ç 
```

å‘é€åˆ°IPCç®¡é“ä¸­çš„å®é™…ä¸Šæ˜¯æˆ‘ä»¬è¦å‘é€çš„å¥æŸ„æ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªmessageå¯¹è±¡åœ¨å†™å…¥åˆ°IPCç®¡é“æ—¶ï¼Œä¹Ÿä¼šé€šè¿‡`JSON.stringfy()`è¿›è¡Œåºåˆ—åŒ–ã€‚æ‰€ä»¥æœ€ç»ˆå‘é€åˆ°IPCé€šé“ä¸­çš„ä¿¡æ¯éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œsend()æ–¹æ³•èƒ½å‘é€æ¶ˆæ¯å’Œå¥æŸ„å¹¶ä¸æ„å‘³ç€å®ƒèƒ½å‘é€ä»»ä½•å¯¹è±¡ã€‚

è¿æ¥äº†IPCé€šé“çš„å­çº¿ç¨‹å¯ä»¥è¯»å–çˆ¶è¿›ç¨‹å‘æ¥çš„æ¶ˆæ¯ï¼Œå°†å­—ç¬¦ä¸²é€šè¿‡JSON.parse()è§£æè¿˜åŸä¸ºå¯¹è±¡åï¼Œæ‰è§¦å‘messageäº‹ä»¶å°†æ¶ˆæ¯ä¼ é€’ç»™åº”ç”¨å±‚ä½¿ç”¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯å¯¹è±¡è¿˜è¦è¢«è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œmessage.cmdçš„å€¼å¦‚æœä»¥NODE_ä¸ºå‰ç¼€ï¼Œå®ƒå°†å“åº”ä¸€ä¸ªå†…éƒ¨äº‹ä»¶internalMessageï¼Œå¦‚æœmessage.cmdå€¼ä¸ºNODE_HANDLE,å®ƒå°†å–å‡º`message.type`å€¼å’Œå¾—åˆ°çš„æ–‡ä»¶æè¿°ç¬¦ä¸€èµ·è¿˜åŸå‡ºä¸€ä¸ªå¯¹åº”çš„å¯¹è±¡ã€‚

ä»¥å‘é€çš„TCPæœåŠ¡å™¨å¥æŸ„ä¸ºä¾‹ï¼Œå­è¿›ç¨‹æ”¶åˆ°æ¶ˆæ¯åçš„è¿˜åŸè¿‡ç¨‹ä»£ç å¦‚ä¸‹:

```
function(message,handle,emit){
    var self = this;
    
    var server = new net.Server();
    server.listen(handler,function(){
      emit(server);
    });
}
å¤åˆ¶ä»£ç 
```

è¿™æ®µè¿˜åŸä»£ç ï¼Œ`å­è¿›ç¨‹æ ¹æ®message.typeåˆ›å»ºå¯¹åº”çš„TCPæœåŠ¡å™¨å¯¹è±¡ï¼Œç„¶åç›‘å¬åˆ°æ–‡ä»¶æè¿°ç¬¦ä¸Š`ã€‚ç”±äºåº•å±‚ç»†èŠ‚ä¸è¢«åº”ç”¨å±‚æ„ŸçŸ¥ï¼Œæ‰€ä»¥å­è¿›ç¨‹ä¸­ï¼Œå¼€å‘è€…ä¼šæœ‰ä¸€ç§æœåŠ¡å™¨å¯¹è±¡å°±æ˜¯ä»çˆ¶è¿›ç¨‹ä¸­ç›´æ¥ä¼ é€’è¿‡æ¥çš„é”™è§‰ã€‚

> Nodeè¿›ç¨‹ä¹‹é—´åªæœ‰æ¶ˆæ¯ä¼ é€’ï¼Œä¸ä¼šçœŸæ­£çš„ä¼ é€’å¯¹è±¡ï¼Œè¿™ç§é”™è§‰æ˜¯æŠ½è±¡å°è£…çš„ç»“æœã€‚ç›®å‰Nodeåªæ”¯æŒæˆ‘å‰é¢æåˆ°çš„å‡ ç§å¥æŸ„ï¼Œå¹¶éä»»æ„ç±»å‹çš„å¥æŸ„éƒ½èƒ½åœ¨è¿›ç¨‹ä¹‹é—´ä¼ é€’ï¼Œé™¤éå®ƒæœ‰å®Œæ•´çš„å‘é€å’Œè¿˜åŸçš„è¿‡ç¨‹ã€‚

#### Node.jså¤šè¿›ç¨‹æ¶æ„æ¨¡å‹

æˆ‘ä»¬è‡ªå·±å®ç°ä¸€ä¸ªå¤šè¿›ç¨‹æ¶æ„å®ˆæŠ¤Demo

![](../_resources/16c565f2d5b5e5c2_tplv-t2oaga2asx_850519ff94cc46b19.webp)

ç¼–å†™ä¸»è¿›ç¨‹

master.js ä¸»è¦å¤„ç†ä»¥ä¸‹é€»è¾‘ï¼š

- åˆ›å»ºä¸€ä¸ª server å¹¶ç›‘å¬ 3000 ç«¯å£ã€‚
- æ ¹æ®ç³»ç»Ÿ cpus å¼€å¯å¤šä¸ªå­è¿›ç¨‹
- é€šè¿‡å­è¿›ç¨‹å¯¹è±¡çš„ send æ–¹æ³•å‘é€æ¶ˆæ¯åˆ°å­è¿›ç¨‹è¿›è¡Œé€šä¿¡
- åœ¨ä¸»è¿›ç¨‹ä¸­ç›‘å¬äº†å­è¿›ç¨‹çš„å˜åŒ–ï¼Œå¦‚æœæ˜¯è‡ªæ€ä¿¡å·é‡æ–°å¯åŠ¨ä¸€ä¸ªå·¥ä½œè¿›ç¨‹ã€‚
- ä¸»è¿›ç¨‹åœ¨ç›‘å¬åˆ°é€€å‡ºæ¶ˆæ¯çš„æ—¶å€™ï¼Œå…ˆé€€å‡ºå­è¿›ç¨‹åœ¨é€€å‡ºä¸»è¿›ç¨‹

```
// master.js
const fork = require('child_process').fork;
const cpus = require('os').cpus();

const server = require('net').createServer();
server.listen(3000);
process.title = 'node-master'

const workers = {};
const createWorker = () => {
    const worker = fork('worker.js')
    worker.on('message', function (message) {
        if (message.act === 'suicide') {
            createWorker();
        }
    })
    worker.on('exit', function(code, signal) {
        console.log('worker process exited, code: %s signal: %s', code, signal);
        delete workers[worker.pid];
    });
    worker.send('server', server);
    workers[worker.pid] = worker;
    console.log('worker process created, pid: %s ppid: %s', worker.pid, process.pid);
}

for (let i=0; i<cpus.length; i++) {
    createWorker();
}

process.once('SIGINT', close.bind(this, 'SIGINT')); // kill(2) Ctrl-C
process.once('SIGQUIT', close.bind(this, 'SIGQUIT')); // kill(3) Ctrl-\
process.once('SIGTERM', close.bind(this, 'SIGTERM')); // kill(15) default
process.once('exit', close.bind(this));

function close (code) {
    console.log('è¿›ç¨‹é€€å‡ºï¼', code);

    if (code !== 0) {
        for (let pid in workers) {
            console.log('master process exited, kill worker pid: ', pid);
            workers[pid].kill('SIGINT');
        }
    }

    process.exit(0);
}
å¤åˆ¶ä»£ç 
```

å·¥ä½œè¿›ç¨‹

worker.js å­è¿›ç¨‹å¤„ç†é€»è¾‘å¦‚ä¸‹ï¼š

- åˆ›å»ºä¸€ä¸ª server å¯¹è±¡ï¼Œæ³¨æ„è¿™é‡Œæœ€å¼€å§‹å¹¶æ²¡æœ‰ç›‘å¬ 3000 ç«¯å£
- é€šè¿‡ message äº‹ä»¶æ¥æ”¶ä¸»è¿›ç¨‹ send æ–¹æ³•å‘é€çš„æ¶ˆæ¯
- ç›‘å¬ uncaughtException äº‹ä»¶ï¼Œæ•è·æœªå¤„ç†çš„å¼‚å¸¸ï¼Œå‘é€è‡ªæ€ä¿¡æ¯ç”±ä¸»è¿›ç¨‹é‡å»ºè¿›ç¨‹ï¼Œå­è¿›ç¨‹åœ¨é“¾æ¥å…³é—­ä¹‹åé€€å‡º

```
// worker.js
const http = require('http');
const server = http.createServer((req, res) => {
	res.writeHead(200, {
		'Content-Type': 'text/plan'
	});
	res.end('I am worker, pid: ' + process.pid + ', ppid: ' + process.ppid);
	throw new Error('worker process exception!'); // æµ‹è¯•å¼‚å¸¸è¿›ç¨‹é€€å‡ºã€é‡å¯
});

let worker;
process.title = 'node-worker'
process.on('message', function (message, sendHandle) {
	if (message === 'server') {
		worker = sendHandle;
		worker.on('connection', function(socket) {
			server.emit('connection', socket);
		});
	}
});

process.on('uncaughtException', function (err) {
	console.log(err);
	process.send({act: 'suicide'});
	worker.close(function () {
		process.exit(1);
	})
})
å¤åˆ¶ä»£ç 
```

#### Node.js è¿›ç¨‹å®ˆæŠ¤

##### ä»€ä¹ˆæ˜¯è¿›ç¨‹å®ˆæŠ¤ï¼Ÿ

æ¯æ¬¡å¯åŠ¨ Node.js ç¨‹åºéƒ½éœ€è¦åœ¨å‘½ä»¤çª—å£è¾“å…¥å‘½ä»¤ `node app.js` æ‰èƒ½å¯åŠ¨ï¼Œä½†å¦‚æœæŠŠå‘½ä»¤çª—å£å…³é—­åˆ™Node.js ç¨‹åºæœåŠ¡å°±ä¼šç«‹åˆ»æ–­æ‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå½“æˆ‘ä»¬è¿™ä¸ª Node.js æœåŠ¡æ„å¤–å´©æºƒäº†å°±ä¸èƒ½è‡ªåŠ¨é‡å¯è¿›ç¨‹äº†ã€‚è¿™äº›ç°è±¡éƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çœ‹åˆ°çš„ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡æŸäº›æ–¹å¼æ¥å®ˆæŠ¤è¿™ä¸ªå¼€å¯çš„è¿›ç¨‹ï¼Œæ‰§è¡Œ node app.js å¼€å¯ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ä¹‹åï¼Œæˆ‘è¿˜å¯ä»¥åœ¨è¿™ä¸ªç»ˆç«¯ä¸Šåšäº›åˆ«çš„äº‹æƒ…ï¼Œä¸”ä¸ä¼šç›¸äº’å½±å“ã€‚ï¼Œå½“å‡ºç°é—®é¢˜å¯ä»¥è‡ªåŠ¨é‡å¯ã€‚

##### å¦‚ä½•å®ç°è¿›ç¨‹å®ˆæŠ¤

è¿™é‡Œæˆ‘åªè¯´ä¸€äº›ç¬¬ä¸‰æ–¹çš„è¿›ç¨‹å®ˆæŠ¤æ¡†æ¶ï¼Œpm2 å’Œ forever ï¼Œå®ƒä»¬éƒ½å¯ä»¥å®ç°è¿›ç¨‹å®ˆæŠ¤ï¼Œåº•å±‚ä¹Ÿéƒ½æ˜¯é€šè¿‡ä¸Šé¢è®²çš„ child_process æ¨¡å—å’Œ cluster æ¨¡å— å®ç°çš„ï¼Œè¿™é‡Œå°±ä¸å†æå®ƒä»¬çš„åŸç†ã€‚

pm2 æŒ‡å®šç”Ÿäº§ç¯å¢ƒå¯åŠ¨ä¸€ä¸ªåä¸º test çš„ node æœåŠ¡

```
pm2 start app.js --env production --name test
å¤åˆ¶ä»£ç 
```

**pm2å¸¸ç”¨api**

- `pm2 stop Name/processID` åœæ­¢æŸä¸ªæœåŠ¡ï¼Œé€šè¿‡æœåŠ¡åç§°æˆ–è€…æœåŠ¡è¿›ç¨‹ID
    
- `pm2 delete Name/processID` åˆ é™¤æŸä¸ªæœåŠ¡ï¼Œé€šè¿‡æœåŠ¡åç§°æˆ–è€…æœåŠ¡è¿›ç¨‹ID
    
- `pm2 logs [Name]` æŸ¥çœ‹æ—¥å¿—ï¼Œå¦‚æœæ·»åŠ æœåŠ¡åç§°ï¼Œåˆ™æŒ‡å®šæŸ¥çœ‹æŸä¸ªæœåŠ¡çš„æ—¥å¿—ï¼Œä¸åŠ åˆ™æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
    
- `pm2 start app.js -i 4` é›†ç¾¤ï¼Œ-i å‚æ•°ç”¨æ¥å‘Šè¯‰PM2ä»¥cluster\_modeçš„å½¢å¼è¿è¡Œä½ çš„appï¼ˆå¯¹åº”çš„å«fork\_modeï¼‰ï¼Œåé¢çš„æ•°å­—è¡¨ç¤ºè¦å¯åŠ¨çš„å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚å¦‚æœç»™å®šçš„æ•°å­—ä¸º0ï¼ŒPM2åˆ™ä¼šæ ¹æ®ä½ CPUæ ¸å¿ƒçš„æ•°é‡æ¥ç”Ÿæˆå¯¹åº”çš„å·¥ä½œçº¿ç¨‹ã€‚æ³¨æ„ä¸€èˆ¬åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨cluster_modeæ¨¡å¼ï¼Œæµ‹è¯•æˆ–è€…æœ¬åœ°ç¯å¢ƒä¸€èˆ¬ä½¿ç”¨forkæ¨¡å¼ï¼Œæ–¹ä¾¿æµ‹è¯•åˆ°é”™è¯¯ã€‚
    
- `pm2 reload Name pm2 restart Name` åº”ç”¨ç¨‹åºä»£ç æœ‰æ›´æ–°ï¼Œå¯ä»¥ç”¨é‡è½½æ¥åŠ è½½æ–°ä»£ç ï¼Œä¹Ÿå¯ä»¥ç”¨é‡å¯æ¥å®Œæˆ,reloadå¯ä»¥åšåˆ°0ç§’å®•æœºåŠ è½½æ–°çš„ä»£ç ï¼Œrestartåˆ™æ˜¯é‡æ–°å¯åŠ¨ï¼Œç”Ÿäº§ç¯å¢ƒä¸­å¤šç”¨reloadæ¥å®Œæˆä»£ç æ›´æ–°ï¼
    
- `pm2 show Name` æŸ¥çœ‹æœåŠ¡è¯¦æƒ…
    
- `pm2 list` æŸ¥çœ‹pm2ä¸­æ‰€æœ‰é¡¹ç›®
    
- `pm2 monit`ç”¨monitå¯ä»¥æ‰“å¼€å®æ—¶ç›‘è§†å™¨å»æŸ¥çœ‹èµ„æºå ç”¨æƒ…å†µ
    

**pm2 å®˜ç½‘åœ°å€ï¼š**

> [pm2.keymetrics.io/docs/usage/â€¦](https://link.juejin.cn?target=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fquick-start%2F "http://pm2.keymetrics.io/docs/usage/quick-start/")

forever å°±ä¸ç‰¹æ®Šè¯´æ˜äº†ï¼Œå®˜ç½‘åœ°å€

> [github.com/foreverjs/fâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fforeverjs%2Fforever "https://github.com/foreverjs/forever")

> æ³¨æ„ï¼šäºŒè€…æ›´æ¨èpm2ï¼Œçœ‹ä¸€ä¸‹äºŒè€…å¯¹æ¯”å°±çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆæ›´æ¨èä½¿ç”¨pm2äº†ã€‚[www.jianshu.com/p/fdc12d82bâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fwww.jianshu.com%2Fp%2Ffdc12d82b661 "https://www.jianshu.com/p/fdc12d82b661")

#### linux å…³é—­ä¸€ä¸ªè¿›ç¨‹

- æŸ¥æ‰¾ä¸è¿›ç¨‹ç›¸å…³çš„PIDå·
    
    ps aux | grep server
    è¯´æ˜:
    

```
 root     20158  0.0  5.0 1251592 95396 ?       Sl   5æœˆ17   1:19 node /srv/mini-program-api/launch_pm2.js
å¤åˆ¶ä»£ç 
```

```
ä¸Šé¢æ˜¯æ‰§è¡Œå‘½ä»¤ååœ¨linuxä¸­æ˜¾ç¤ºçš„ç»“æœï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯è¿›ç¨‹å¯¹åº”çš„PID
å¤åˆ¶ä»£ç 
```

- æ€æ­»è¿›ç¨‹

1.  ä»¥ä¼˜é›…çš„æ–¹å¼ç»“æŸè¿›ç¨‹
    
    kill -l PID
    
    -lé€‰é¡¹å‘Šè¯‰killå‘½ä»¤ç”¨å¥½åƒå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ·å·²æ³¨é”€çš„æ–¹å¼ç»“æŸè¿›ç¨‹ã€‚ å½“ä½¿ç”¨è¯¥é€‰é¡¹æ—¶ï¼Œkillå‘½ä»¤ä¹Ÿè¯•å›¾æ€æ­»æ‰€ç•™ä¸‹çš„å­è¿›ç¨‹ã€‚ ä½†è¿™ä¸ªå‘½ä»¤ä¹Ÿä¸æ˜¯æ€»èƒ½æˆåŠŸ--æˆ–è®¸ä»ç„¶éœ€è¦å…ˆæ‰‹å·¥æ€æ­»å­è¿›ç¨‹ï¼Œç„¶åå†æ€æ­»çˆ¶è¿›ç¨‹ã€‚
    
2.  kill å‘½ä»¤ç”¨äºç»ˆæ­¢è¿›ç¨‹
    

```
ä¾‹å¦‚ï¼š `kill -9 [PID]`
å¤åˆ¶ä»£ç 
```

-9 è¡¨ç¤ºå¼ºè¿«è¿›ç¨‹ç«‹å³åœæ­¢

```
è¿™ä¸ªå¼ºå¤§å’Œå±é™©çš„å‘½ä»¤è¿«ä½¿è¿›ç¨‹åœ¨è¿è¡Œæ—¶çªç„¶ç»ˆæ­¢ï¼Œè¿›ç¨‹åœ¨ç»“æŸåä¸èƒ½è‡ªæˆ‘æ¸…ç†ã€‚
å±å®³æ˜¯å¯¼è‡´ç³»ç»Ÿèµ„æºæ— æ³•æ­£å¸¸é‡Šæ”¾ï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨ï¼Œé™¤éå…¶ä»–åŠæ³•éƒ½æ— æ•ˆã€‚
å½“ä½¿ç”¨æ­¤å‘½ä»¤æ—¶ï¼Œä¸€å®šè¦é€šè¿‡ps -efç¡®è®¤æ²¡æœ‰å‰©ä¸‹ä»»ä½•åƒµå°¸è¿›ç¨‹ã€‚
åªèƒ½é€šè¿‡ç»ˆæ­¢çˆ¶è¿›ç¨‹æ¥æ¶ˆé™¤åƒµå°¸è¿›ç¨‹ã€‚å¦‚æœåƒµå°¸è¿›ç¨‹è¢«initæ”¶å…»ï¼Œé—®é¢˜å°±æ¯”è¾ƒä¸¥é‡äº†ã€‚
æ€æ­»initè¿›ç¨‹æ„å‘³ç€å…³é—­ç³»ç»Ÿã€‚
å¦‚æœç³»ç»Ÿä¸­æœ‰åƒµå°¸è¿›ç¨‹ï¼Œå¹¶ä¸”å…¶çˆ¶è¿›ç¨‹æ˜¯initï¼Œ
è€Œä¸”åƒµå°¸è¿›ç¨‹å ç”¨äº†å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æŸä¸ªæ—¶å€™é‡å¯æœºå™¨ä»¥æ¸…é™¤è¿›ç¨‹è¡¨äº†ã€‚
å¤åˆ¶ä»£ç 
```

3.  killallå‘½ä»¤
    
    æ€æ­»åŒä¸€è¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹ã€‚å…¶å…è®¸æŒ‡å®šè¦ç»ˆæ­¢çš„è¿›ç¨‹çš„åç§°ï¼Œè€ŒéPIDã€‚
    
    `killall httpd`
    

### Node.js çº¿ç¨‹

#### Node.jså…³äºå•çº¿ç¨‹çš„è¯¯åŒº

```
const http = require('http');

const server = http.createServer();
server.listen(3000,()=>{
    process.title='ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—æµ‹è¯•è¿›ç¨‹';
    console.log('è¿›ç¨‹id',process.pid)
})
å¤åˆ¶ä»£ç 
```

ä»ç„¶çœ‹æœ¬æ–‡ç¬¬ä¸€æ®µä»£ç ï¼Œåˆ›å»ºäº†httpæœåŠ¡ï¼Œå¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½è¯´äº†Node.jsæ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥ Node å¯åŠ¨åçº¿ç¨‹æ•°åº”è¯¥ä¸º 1ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šå¼€å¯7ä¸ªçº¿ç¨‹å‘¢ï¼Ÿéš¾é“Javascriptä¸æ˜¯å•çº¿ç¨‹ä¸çŸ¥é“å°ä¼™ä¼´ä»¬æœ‰æ²¡æœ‰è¿™ä¸ªç–‘é—®ï¼Ÿ

è§£é‡Šä¸€ä¸‹è¿™ä¸ªåŸå› ï¼š

Node ä¸­æœ€æ ¸å¿ƒçš„æ˜¯ v8 å¼•æ“ï¼Œåœ¨ Node å¯åŠ¨åï¼Œä¼šåˆ›å»º v8 çš„å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æ˜¯å¤šçº¿ç¨‹çš„ã€‚

- ä¸»çº¿ç¨‹ï¼šç¼–è¯‘ã€æ‰§è¡Œä»£ç ã€‚
- ç¼–è¯‘/ä¼˜åŒ–çº¿ç¨‹ï¼šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä¼˜åŒ–ä»£ç ã€‚
- åˆ†æå™¨çº¿ç¨‹ï¼šè®°å½•åˆ†æä»£ç è¿è¡Œæ—¶é—´ï¼Œä¸º Crankshaft ä¼˜åŒ–ä»£ç æ‰§è¡Œæä¾›ä¾æ®ã€‚
- åƒåœ¾å›æ”¶çš„å‡ ä¸ªçº¿ç¨‹ã€‚

æ‰€ä»¥å¤§å®¶å¸¸è¯´çš„ Node æ˜¯å•çº¿ç¨‹çš„æŒ‡çš„æ˜¯ JavaScript çš„æ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„(å¼€å‘è€…ç¼–å†™çš„ä»£ç è¿è¡Œåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­)ï¼Œä½† Javascript çš„å®¿ä¸»ç¯å¢ƒï¼Œæ— è®ºæ˜¯ Node è¿˜æ˜¯æµè§ˆå™¨éƒ½æ˜¯å¤šçº¿ç¨‹çš„å› ä¸ºlibuvä¸­æœ‰çº¿ç¨‹æ± çš„æ¦‚å¿µå­˜åœ¨çš„ï¼Œlibuvä¼šé€šè¿‡ç±»ä¼¼çº¿ç¨‹æ± çš„å®ç°æ¥æ¨¡æ‹Ÿä¸åŒæ“ä½œç³»ç»Ÿçš„å¼‚æ­¥è°ƒç”¨ï¼Œè¿™å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚

#### æŸäº›å¼‚æ­¥ IO ä¼šå ç”¨é¢å¤–çš„çº¿ç¨‹

è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å®šæ—¶å™¨æ‰§è¡Œçš„åŒæ—¶ï¼Œå»è¯»ä¸€ä¸ªæ–‡ä»¶ï¼š

```
const fs = require('fs')
setInterval(() => {
    console.log(new Date().getTime())
}, 3000)

fs.readFile('./index.html', () => {})
å¤åˆ¶ä»£ç 
```

çº¿ç¨‹æ•°é‡å˜æˆäº† 11 ä¸ªï¼Œè¿™æ˜¯å› ä¸ºåœ¨ Node ä¸­æœ‰ä¸€äº› IO æ“ä½œï¼ˆDNSï¼ŒFSï¼‰å’Œä¸€äº› CPU å¯†é›†è®¡ç®—ï¼ˆZlibï¼ŒCryptoï¼‰ä¼šå¯ç”¨ Node çš„çº¿ç¨‹æ± ï¼Œè€Œçº¿ç¨‹æ± é»˜è®¤å¤§å°ä¸º 4ï¼Œå› ä¸ºçº¿ç¨‹æ•°å˜æˆäº† 11ã€‚ æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ›´æ”¹çº¿ç¨‹æ± é»˜è®¤å¤§å°ï¼š

```
process.env.UV_THREADPOOL_SIZE = 64
å¤åˆ¶ä»£ç 
```

ä¸€è¡Œä»£ç è½»æ¾æŠŠçº¿ç¨‹å˜æˆ 71ã€‚

##### Libuv

Libuv æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼‚æ­¥IOåº“ï¼Œå®ƒç»“åˆäº†UNIXä¸‹çš„libevå’ŒWindowsä¸‹çš„IOCPçš„ç‰¹æ€§ï¼Œæœ€æ—©ç”±Nodeçš„ä½œè€…å¼€å‘ï¼Œä¸“é—¨ä¸ºNodeæä¾›å¤šå¹³å°ä¸‹çš„å¼‚æ­¥IOæ”¯æŒã€‚Libuvæœ¬èº«æ˜¯ç”±C++è¯­è¨€å®ç°çš„ï¼ŒNodeä¸­çš„éè‹å¡IOä»¥åŠäº‹ä»¶å¾ªç¯çš„åº•å±‚æœºåˆ¶éƒ½æ˜¯ç”±libuvå®ç°çš„ã€‚

libuvæ¶æ„å›¾

![](../_resources/16c565ec3aaa0424_tplv-t2oaga2asx_2fba14e35e764245b.webp)

åœ¨Windowç¯å¢ƒä¸‹ï¼Œlibuvç›´æ¥ä½¿ç”¨Windowsçš„IOCPæ¥å®ç°å¼‚æ­¥IOã€‚åœ¨éWindowsç¯å¢ƒä¸‹ï¼Œlibuvä½¿ç”¨å¤šçº¿ç¨‹æ¥æ¨¡æ‹Ÿå¼‚æ­¥IOã€‚

æ³¨æ„ä¸‹é¢æˆ‘è¦è¯´çš„è¯ï¼ŒNodeçš„å¼‚æ­¥è°ƒç”¨æ˜¯ç”±libuvæ¥æ”¯æŒçš„ï¼Œä»¥ä¸Šé¢çš„è¯»å–æ–‡ä»¶çš„ä¾‹å­ï¼Œè¯»æ–‡ä»¶å®è´¨çš„ç³»ç»Ÿè°ƒç”¨æ˜¯ç”±libuvæ¥å®Œæˆçš„ï¼ŒNodeåªæ˜¯è´Ÿè´£è°ƒç”¨libuvçš„æ¥å£ï¼Œç­‰æ•°æ®è¿”å›åå†æ‰§è¡Œå¯¹åº”çš„å›è°ƒæ–¹æ³•ã€‚

#### Node.js çº¿ç¨‹åˆ›å»º

ç›´åˆ° Node 10.5.0 çš„å‘å¸ƒï¼Œå®˜æ–¹æ‰ç»™å‡ºäº†ä¸€ä¸ªå®éªŒæ€§è´¨çš„æ¨¡å— worker_threads ç»™ Node æä¾›çœŸæ­£çš„å¤šçº¿ç¨‹èƒ½åŠ›ã€‚

å…ˆçœ‹ä¸‹ç®€å•çš„ demoï¼š

```
const {
  isMainThread,
  parentPort,
  workerData,
  threadId,
  MessageChannel,
  MessagePort,
  Worker
} = require('worker_threads');

function mainThread() {
  for (let i = 0; i < 5; i++) {
    const worker = new Worker(__filename, { workerData: i });
    worker.on('exit', code => { console.log(`main: worker stopped with exit code ${code}`); });
    worker.on('message', msg => {
      console.log(`main: receive ${msg}`);
      worker.postMessage(msg + 1);
    });
  }
}

function workerThread() {
  console.log(`worker: workerDate ${workerData}`);
  parentPort.on('message', msg => {
    console.log(`worker: receive ${msg}`);
  }),
  parentPort.postMessage(workerData);
}

if (isMainThread) {
  mainThread();
} else {
  workerThread();
}
å¤åˆ¶ä»£ç 
```

ä¸Šè¿°ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸­å¼€å¯äº”ä¸ªå­çº¿ç¨‹ï¼Œå¹¶ä¸”ä¸»çº¿ç¨‹å‘å­çº¿ç¨‹å‘é€ç®€å•çš„æ¶ˆæ¯ã€‚

ç”±äº worker_thread ç›®å‰ä»ç„¶å¤„äºå®éªŒé˜¶æ®µï¼Œæ‰€ä»¥å¯åŠ¨æ—¶éœ€è¦å¢åŠ  --experimental-worker flagï¼Œè¿è¡Œåè§‚å¯Ÿæ´»åŠ¨ç›‘è§†å™¨ï¼Œå¼€å¯äº†5ä¸ªå­çº¿ç¨‹

![](../_resources/16c6cfb939b5b268_tplv-t2oaga2asx_6e1a0ecb9fd74127b.webp)

##### worker_thread æ¨¡å—

worker\_thread æ ¸å¿ƒä»£ç ï¼ˆåœ°å€https://github.com/nodejs/node/blob/master/lib/worker\_threads.jsï¼‰ worker_thread æ¨¡å—ä¸­æœ‰ 4 ä¸ªå¯¹è±¡å’Œ 2 ä¸ªç±»ï¼Œå¯ä»¥è‡ªå·±å»çœ‹ä¸Šé¢çš„æºç ã€‚

- isMainThread: æ˜¯å¦æ˜¯ä¸»çº¿ç¨‹ï¼Œæºç ä¸­æ˜¯é€šè¿‡ threadId === 0 è¿›è¡Œåˆ¤æ–­çš„ã€‚
- MessagePort: ç”¨äºçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œç»§æ‰¿è‡ª EventEmitterã€‚
- MessageChannel: ç”¨äºåˆ›å»ºå¼‚æ­¥ã€åŒå‘é€šä¿¡çš„é€šé“å®ä¾‹ã€‚
- threadId: çº¿ç¨‹ IDã€‚
- Worker: ç”¨äºåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå­çº¿ç¨‹ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸º filenameï¼Œè¡¨ç¤ºå­çº¿ç¨‹æ‰§è¡Œçš„å…¥å£ã€‚
- parentPort: åœ¨ worker çº¿ç¨‹é‡Œæ˜¯è¡¨ç¤ºçˆ¶è¿›ç¨‹çš„ MessagePort ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨ä¸»çº¿ç¨‹é‡Œä¸º null
- workerData: ç”¨äºåœ¨ä¸»è¿›ç¨‹ä¸­å‘å­è¿›ç¨‹ä¼ é€’æ•°æ®ï¼ˆdata å‰¯æœ¬ï¼‰

## æ€»ç»“

**å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹**

å¯¹æ¯”ä¸€ä¸‹å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼š

| å±æ€§  | å¤šè¿›ç¨‹ | å¤šçº¿ç¨‹ | æ¯”è¾ƒ  |
| --- | --- | --- | --- |
| æ•°æ®  | æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å• | å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚ | å„æœ‰åƒç§‹ |
| CPUã€å†…å­˜ | å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPUåˆ©ç”¨ç‡ä½ | å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPUåˆ©ç”¨ç‡é«˜ | å¤šçº¿ç¨‹æ›´å¥½ |
| é”€æ¯ã€åˆ‡æ¢ | åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢ | åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿« | å¤šçº¿ç¨‹æ›´å¥½ |
| coding | ç¼–ç ç®€å•ã€è°ƒè¯•æ–¹ä¾¿ | ç¼–ç ã€è°ƒè¯•å¤æ‚ | ç¼–ç ã€è°ƒè¯•å¤æ‚ |
| å¯é æ€§ | è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“ | çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿ | å¤šè¿›ç¨‹æ›´å¥½ |
| åˆ†å¸ƒå¼ | å¯ç”¨äºå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºæ‰©å±• | åªèƒ½ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼ | å¤šè¿›ç¨‹æ›´å¥½ |

å‚è€ƒæ–‡ç« ï¼š

- Nodeä¸­child_processæ¨¡å—çš„ä½¿ç”¨:[juejin.cn/post/684490â€¦](https://juejin.cn/post/6844903615237193742)
- æœ´çµè€å¸ˆçš„ä¹¦ç±ã€Node.js æ·±å…¥æµ…å‡ºã€‘
- æ·˜å®å‰ç«¯å›¢é˜Ÿclusterè®²è§£:[taobaofed.org/blog/2015/1â€¦](https://link.juejin.cn?target=http%3A%2F%2Ftaobaofed.org%2Fblog%2F2015%2F11%2F03%2Fnodejs-cluster%2F "http://taobaofed.org/blog/2015/11/03/nodejs-cluster/")

åŠ å…¥æˆ‘ä»¬ä¸€èµ·å­¦ä¹ å§ï¼

![](../_resources/16b8a3d23a52b7d0_tplv-t2oaga2asx_186f95ad43d04b55b.webp)

nodeå­¦ä¹ äº¤æµç¾¤

åˆ†ç±»ï¼š

[å‰ç«¯](https://juejin.cn/frontend)

æ ‡ç­¾ï¼š

[Node.js](https://juejin.cn/tag/Node.js)[å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)

[å®‰è£…æ˜é‡‘æµè§ˆå™¨æ’ä»¶](https://juejin.cn/extension/?utm_source=standalone&utm_medium=post&utm_campaign=extension_promotion)

å¤šå†…å®¹èšåˆæµè§ˆã€å¤šå¼•æ“å¿«æ·æœç´¢ã€å¤šå·¥å…·ä¾¿æ·ææ•ˆã€å¤šæ¨¡å¼éšå¿ƒç•…äº«ï¼Œä½ æƒ³è¦çš„ï¼Œè¿™é‡Œéƒ½æœ‰ï¼

[å‰å¾€å®‰è£…](https://juejin.cn/extension/?utm_source=standalone&utm_medium=post&utm_campaign=extension_promotion)

ç›¸å…³è¯¾ç¨‹

<img width="80" height="112" src="../_resources/172d14d866d42a2a_tplv-t2oaga2asx_758d4dafbe94446db.webp"/>

VIP

å‰ç«¯ç®—æ³•ä¸æ•°æ®ç»“æ„é¢è¯•ï¼šåº•å±‚é€»è¾‘è§£è¯»ä¸å¤§å‚çœŸé¢˜è®­ç»ƒ

[ä¿®è¨€](https://juejin.cn/user/2400989094885495)

6288è´­ä¹°

Â¥14.95

Â¥29.9

é¦–å•åˆ¸åä»·

é¦–å•åˆ¸åä»·

<img width="80" height="112" src="../_resources/8e5a1a8657c74478becca7b4157a8e33_3037d3070ae44bc79.webp"/>

VIP

React è¿›é˜¶å®è·µæŒ‡å—

[æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº <img width="35" height="16" src="../_resources/lv-6.b69935b_1221cd041a694ac0b64aaf1d8bd9a4ed.png"/><br>![](../_resources/07302452a7ad81cb43a173b5cd580237_c8063dadcdba4a599.svg)](https://juejin.cn/user/2418581313687390) 

6225è´­ä¹°

Â¥24.95

Â¥49.9

é¦–å•åˆ¸åä»·

é¦–å•åˆ¸åä»·

è¯„è®º

<img width="40" height="40" src="../_resources/d82c8f00b71fb893680ea7117414d539_f64da21cdb05481da.webp"/>

å…¨éƒ¨è¯„è®º 71

æœ€æ–°

æœ€çƒ­

[<img width="40" height="40" src="../_resources/bdad6600c76afb857c84527cf0ac0272_af4849c365a74bb09.webp"/>](https://juejin.cn/user/78820568473181)

[å¼‚å½© <img width="35" height="16" src="../_resources/lv-3.7938ebc_2413d965382e4a328d4d254338e0379a.png"/> <img width="45" height="16" src="../_resources/8c6985e2aa4c06f307ae3734da4b43ac_8a7e29af58a34ccea.svg"/>](https://juejin.cn/user/78820568473181) 

å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ @ åŒ—äº¬ 4æœˆå‰

å¤§ä½¬
1.forkçš„ä¸ªæ•°ä¸ºå•¥æ˜¯cpuçš„æ ¸æ•°ï¼Œä¸»è¿›ç¨‹ä¸ä¹Ÿå ç”¨ä¸€ä¸ªå—ï¼Ÿ
2.å…³äºå¥—å­—èŠ‚å’Œæ–‡ä»¶æè¿°ç¬¦æ²¡å¤ªæ˜ç™½ã€‚åˆ°åº•æ˜¯ä¸»è¿›ç¨‹å¯åŠ¨ä¸€ä¸ªnetServerè¿˜æ˜¯å­è¿›ç¨‹å¯åŠ¨ä¸€ä¸ªnet Serverï¼Ÿ

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/213928ed37ec02109101eaa621a85c36_1c0f8f251d5a48878.webp"/>](https://juejin.cn/user/835284566811192)

[jeffacodeåŒå­¦ <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/835284566811192) 

å‰ç«¯å¼€å‘ @ é˜¿é‡Œå·´å·´åŠèš‚èšé›†å›¢ 8æœˆå‰

ã€Œåœ¨Windowç¯å¢ƒä¸‹ï¼Œlibuvç›´æ¥ä½¿ç”¨Windowsçš„IOCPæ¥å®ç°å¼‚æ­¥IOã€‚åœ¨éWindowsç¯å¢ƒä¸‹ï¼Œlibuvä½¿ç”¨å¤šçº¿ç¨‹æ¥æ¨¡æ‹Ÿå¼‚æ­¥IOã€è¿™ä¸ªç†è§£å¥½åƒä¸å¤ªå¯¹ã€‚I/Oæœ‰å››ç§ï¼šåŒæ­¥é˜»å¡ï¼ŒåŒæ­¥éé˜»å¡ï¼Œå¼‚æ­¥é˜»å¡ï¼Œå¼‚æ­¥éé˜»å¡ï¼Œä½†Nodeè¦çš„æ˜¯å¼‚æ­¥éé˜»å¡I/Oï¼Œåªæœ‰ç½‘ç»œI/Oåœ¨å„ä¸ªå¹³å°ä¸‹çš„å®ç°éƒ½æ˜¯å¼‚æ­¥éé˜»å¡I/Oï¼Œéç½‘ç»œI/Oï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™ï¼ŒDNSè§£æç­‰ï¼Œä¸åŒå¹³å°çš„å®ç°å°±åƒå·®ä¸‡åˆ«ï¼Œlinuxä¸Šå°±æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥é’ˆå¯¹éç½‘ç»œI/Oï¼Œlibuvç”¨çº¿ç¨‹æ± æ¥å®ç°äº†è‡ªå·±çš„ä¸€å¥—ç»Ÿä¸€çš„æ§åˆ¶ã€‚

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/151ce367ed270b3be4f3341111461d3a_27dbbb2851fa4f3bb.webp"/>](https://juejin.cn/user/184373684471821)

[jamiescou <img width="35" height="16" src="../_resources/lv-1.9d93e13_9b8f2e4212614e78a8a5a2079f51fe14.png"/> <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/184373684471821) 

å‰ç«¯å¼€å‘ @ ä¸­å›½è½¯ä»¶ 9æœˆå‰

æŒºå¥½çš„æ–‡ç« ï¼Œå¾ˆå—ç”¨

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/1730fc3d9c33f7bb_tplv-t2oaga2asx_6b246228de3f46b8a.webp"/>](https://juejin.cn/user/2225067265107543)

[ä¸“ä¸šæ½œæ°´äºŒåå¹´ <img width="35" height="16" src="../_resources/lv-1.9d93e13_9b8f2e4212614e78a8a5a2079f51fe14.png"/> <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/2225067265107543) 

å‰ç«¯ 1å¹´å‰

é«˜æ°´å¹³æ–‡ç«  æ„Ÿè°¢åˆ†äº«

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/e9915457cb6db9371379f3535bb91e2a_65b8776b2b1c470a9.webp"/>](https://juejin.cn/user/553809588530973)

[å›½å†…è‘—åç¼–ç¨‹ç –å®¶ <img width="45" height="16" src="../_resources/69eb0ad2f93abf938e832fe53b979c10_639a3572f2d94566a.svg"/>](https://juejin.cn/user/553809588530973) 

javaå¼€å‘ç¨‹åºå‘˜ 1å¹´å‰

çº¿ç¨‹æ•°4ï¼Œ11ï¼Œ64ï¼Œ71ï¼Œçœ‹çš„æˆ‘è«åå…¶å¦™ï¼Œå“ªé‡Œæ¥çš„æ•°æ®ï¼Ÿå¦‚æœæ˜¯è®¡ç®—çš„ï¼Œè®¡ç®—å…¬å¼æ˜¯ä»€ä¹ˆï¼Ÿ

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/483da0a667cd5cc024b3a62aef751579_f1d8ebeed5bb40f0a.webp"/>](https://juejin.cn/user/87567071453911)

[æŸæ—¶æ©™ <img width="35" height="16" src="../_resources/lv-3.7938ebc_2413d965382e4a328d4d254338e0379a.png"/> <img width="45" height="16" src="../_resources/8c6985e2aa4c06f307ae3734da4b43ac_8a7e29af58a34ccea.svg"/>](https://juejin.cn/user/87567071453911) 

å‰ç«¯ 1å¹´å‰

çœ‹å®Œäº†ï¼Œå¾ˆå‰å®³ã€‚

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/76587f300afdfdad0947c4e0de5facd6_17cf4371a67b455ca.webp"/>](https://juejin.cn/user/1063982986456334)

[ä¸‡å¤«é›„ <img width="45" height="16" src="../_resources/8c6985e2aa4c06f307ae3734da4b43ac_8a7e29af58a34ccea.svg"/>](https://juejin.cn/user/1063982986456334) 

å‰ç«¯ 1å¹´å‰

å¤šè¿›ç¨‹ä¸æ˜¯åˆ©ç”¨ç‡é«˜å—

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/1bf58cd098cf0a7766aa83b991cfc571_bfd572fd52d649599.webp"/>](https://juejin.cn/user/4054654614244717)

[piece <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/4054654614244717) 

1å¹´å‰

fork_app.js è¿è¡Œ, åŒæ—¶å‘é€ä¸¤ä¸ª /compute è¯·æ±‚, ä»ç„¶æ˜¯è¢«é˜»å¡çš„

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/31c32afd1842854bfee0fb7019f671db_ce572c56151046949.webp"/>](https://juejin.cn/user/2576910984682366)

[èµ›æ–‡Seven7 <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/2576910984682366) 

1å¹´å‰

ä½ å¥½ï¼Œè¯·é—®è¿™å¥è¯ï¼šä¸€ä¸ªçº¿ç¨‹åªèƒ½éš¶å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹çš„ã€‚è¿™é‡Œæ˜¯å¤šä¸ªè¿›ç¨‹ä½†æ˜¯éƒ½æ˜¯7è¿™ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªæ€ä¹ˆç†è§£å‘¢ï¼Ÿ

<img width="72" height="72" src="../_resources/64d9c596a0d040a1a1bd35031903432e_0d6911e451d141018.webp"/>

ç‚¹èµ

1

[<img width="24" height="24" src="../_resources/16a0b9cba3cc814c7fa_tplv-t2oaga2_80d517bc7d364a63a.webp"/>](https://juejin.cn/user/2189882894086414)

[datou](https://juejin.cn/user/2189882894086414)

1å¹´å‰

åº”è¯¥æ˜¯æŒ‡ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡ï¼Ÿ

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/eafc9e4dec3142280eb7ff345c274e27_61668c387b314113a.webp"/>](https://juejin.cn/user/4248168660219261)

[dafeige <img width="35" height="16" src="../_resources/lv-3.7938ebc_2413d965382e4a328d4d254338e0379a.png"/> <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/4248168660219261) 

ç¨‹åºçŒ¿ 2å¹´å‰

ç‚¹èµ 66666

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/87eda3ae5f394c1c5d5cb383ab81007e_17a8680e398945478.webp"/>](https://juejin.cn/user/624178336902872)

[JhoneMingyoung <img width="35" height="16" src="../_resources/lv-1.9d93e13_9b8f2e4212614e78a8a5a2079f51fe14.png"/> <img width="45" height="16" src="../_resources/69eb0ad2f93abf938e832fe53b979c10_639a3572f2d94566a.svg"/>](https://juejin.cn/user/624178336902872) 

å‰ç«¯å¼€å‘è€… @ æŸå°å‚ 2å¹´å‰

ç‚¹èµ<img width="0" height="20" src="../_resources/1f44d.svg_tplv-t2oaga2asx-image_d8767adbc6c346c9bd.svg"/>

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/5035712059_100x100_545cd989572243a48e2f17f0f70872e.webp"/>](https://juejin.cn/user/958429872536670)

[åœŸåŒªåƒç“œ <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/958429872536670) 

å‰ç«¯ 2å¹´å‰

è†œæ‹œ

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/16ac4dd2fa2ce44f934_tplv-t2oaga2_93b6e88a3ee44469b.webp"/>](https://juejin.cn/user/2717648476199256)

[zhangdianp <img width="35" height="16" src="../_resources/lv-3.7938ebc_2413d965382e4a328d4d254338e0379a.png"/> <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/2717648476199256) 

æœåŠ¡ç«¯å¼€å‘ @ ç½‘æ˜“ 2å¹´å‰

è†œæ‹œï¼Œå¤§ä½¬ï¼Œå­¦ä¹ äº†<img width="0" height="20" src="../_resources/1f44d.svg_tplv-t2oaga2asx-image_d8767adbc6c346c9bd.svg"/>

ç‚¹èµ

1

[<img width="24" height="24" src="../_resources/16d42ae0d6d59e39_tplv-t2oaga2asx_69fe8d08c55149158.webp"/>](https://juejin.cn/user/430664257636407)

[ikoala](https://juejin.cn/user/430664257636407)

ï¼ˆä½œè€…ï¼‰ 2å¹´å‰

äº’ç›¸å­¦ä¹ ï¼Œä¸€èµ·æˆé•¿<img width="0" height="20" src="../_resources/1f604.svg_tplv-t2oaga2asx-image_668f95c662d541dd88.svg"/>

ç‚¹èµ

å›å¤

[![æ¿€å…‰ä¸­çš„å¤´åƒ](https://xx.a8848.store/cdn/images/14.jpg)](https://juejin.cn/user/1415826709165416)

[æ¿€å…‰ä¸­ <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/1415826709165416) 

2å¹´å‰

ä¸é”™

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/3044413937_100x100_016a664c84294280baa57b556be70af.webp"/>](https://juejin.cn/user/1978776663365517)

[51a5a380021511ea8796d388bb83d9df <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/1978776663365517) 

3å¹´å‰

\[å†…å®¹è¿è§„\]

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/3044413937_100x100_016a664c84294280baa57b556be70af.webp"/>](https://juejin.cn/user/1697301686657997)

[16881850fc4d11e9a2277315bd30a5b6 <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/1697301686657997) 

3å¹´å‰

\[å†…å®¹è¿è§„\]

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/2975850990_100x100_4d1f39eb0a23417eb5c8d61604206db.webp"/>](https://juejin.cn/user/2541726616022366)

[49b47480fc7f11e981334d185565d2b4 <img width="45" height="16" src="../_resources/9b2f31c663d17de59dd9e5fff272bb85_ace8c8e988c64ed3b.svg"/>](https://juejin.cn/user/2541726616022366) 

3å¹´å‰

\[å†…å®¹è¿è§„\]

1

å›å¤

[<img width="40" height="40" src="../_resources/ff57d88c52aa4322866860625efe087d_3831d9ee479c49fb9.webp"/>](https://juejin.cn/user/4054654612159245)

[å·²æ³¨é”€](https://juejin.cn/user/4054654612159245)

3å¹´å‰

ä¸é”™ï¼Œä¸è¿‡å°‘äº†çˆ¶è¿›ç¨‹æŠŠ connection äº‹ä»¶å’Œè¿æ¥ socket ä¼ é€’ç»™å­è¿›ç¨‹çš„éƒ¨åˆ†ã€‚

ç‚¹èµ

å›å¤

[<img width="40" height="40" src="../_resources/164c63027415c815_tplv-t2oaga2asx_f2e67ca645b74b1b9.webp"/>](https://juejin.cn/user/4089838986343405)

[jaycaoln <img width="35" height="16" src="../_resources/lv-3.7938ebc_2413d965382e4a328d4d254338e0379a.png"/> <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/><br>![](../_resources/ffdbad884aa0e7884cbcf924226df6ce_5015944275c64f1ab.svg)](https://juejin.cn/user/4089838986343405) 

Webå‰ç«¯ @ bilibili 3å¹´å‰

åŸºæœ¬ç…§æŠ„nodeæ·±å…¥æµ…å‡ºå•Š....

ç‚¹èµ

4

[<img width="24" height="24" src="../_resources/16d42ae0d6d59e39_tplv-t2oaga2asx_69fe8d08c55149158.webp"/>](https://juejin.cn/user/430664257636407)

[ikoala](https://juejin.cn/user/430664257636407)

ï¼ˆä½œè€…ï¼‰ 3å¹´å‰

å¤§ä½¬ï¼Œæ‚¨åŸºæœ¬è¿™ä¸ªè¯ç”¨çš„çœŸçš„è®©äººæ— è¯­ï¼Œé™¤äº†å¥æŸ„ä¼ é€’é‚£ï¼Œæ€ä¹ˆå°±åŸºæœ¬äº†ï¼Œè€Œä¸”ä¹Ÿæ ‡æ˜äº†å‚è€ƒï¼Œè¯·å°Šé‡ä¸€ä¸‹ä½œè€…ï¼Œæ„Ÿæ¿€æ¶•é›¶ï¼Œæˆ‘ä¹Ÿæ ‡æ˜äº†æœ´çµè€å¸ˆï¼ŒçœŸçš„æä¸æ‡‚ï¼Œå”‰

7

å›å¤

[<img width="24" height="24" src="../_resources/3a9ed0159403e3c7ad88910cdc57b207_78bf8a0508324fe38.webp"/>](https://juejin.cn/user/448256474626983)

[è¯·_å«æˆ‘è‹è½¼å¥½å—](https://juejin.cn/user/448256474626983)

å›å¤

[ikoala](https://juejin.cn/user/430664257636407)

2å¹´å‰

æ€»æœ‰å†™é¸¡è›‹é‡Œé¢æŒ‘éª¨å¤´çš„äºº <img width="0" height="20" src="../_resources/1f44a.svg_tplv-t2oaga2asx-image_6dfe92a3a4eb40b3bb.svg"/><img width="0" height="20" src="../_resources/1f44a.svg_tplv-t2oaga2asx-image_6dfe92a3a4eb40b3bb.svg"/><img width="0" height="20" src="../_resources/1f44a.svg_tplv-t2oaga2asx-image_6dfe92a3a4eb40b3bb.svg"/>

â€œ

å¤§ä½¬ï¼Œæ‚¨åŸºæœ¬è¿™ä¸ªè¯ç”¨çš„çœŸçš„è®©äººæ— è¯­ï¼Œé™¤äº†å¥æŸ„ä¼ é€’é‚£ï¼Œæ€ä¹ˆå°±åŸºæœ¬äº†ï¼Œè€Œä¸”ä¹Ÿæ ‡æ˜äº†å‚è€ƒï¼Œè¯·å°Šé‡ä¸€ä¸‹ä½œè€…ï¼Œæ„Ÿæ¿€æ¶•é›¶ï¼Œæˆ‘ä¹Ÿæ ‡æ˜äº†æœ´çµè€å¸ˆï¼ŒçœŸçš„æä¸æ‡‚ï¼Œå”‰

â€

ç‚¹èµ

å›å¤

æŸ¥çœ‹æ›´å¤šå›å¤

[<img width="40" height="40" src="../_resources/6bcee1f1ffbffd986ce774aed7d956ce_9b8cde6c67b74e79a.webp"/>](https://juejin.cn/user/1714893870869608)

[é¥è¿œğŸ˜€ <img width="45" height="16" src="../_resources/65a6a28f15d70e5a77bf881c5ec5340d_e2296b54b226462d8.svg"/>](https://juejin.cn/user/1714893870869608) 

å‰ç«¯å¼€å‘ 3å¹´å‰

éå¸¸ä¸é”™

ç‚¹èµ

å›å¤

æŸ¥çœ‹å…¨éƒ¨ 71 æ¡å›å¤

ç›¸å…³æ¨è

- [azuo](https://juejin.cn/user/122746142200264)
    
    3æœˆå‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [åç«¯](https://juejin.cn/tag/%E5%90%8E%E7%AB%AF) [å…¨æ ˆ](https://juejin.cn/tag/%E5%85%A8%E6%A0%88)
    
    [æ€ä¹ˆå°±æ•¢ç”¨NodeJSå†™åƒä¸‡çº§åˆ«çš„æœåŠ¡åç«¯](https://juejin.cn/post/7125341011731185694 "æ€ä¹ˆå°±æ•¢ç”¨NodeJSå†™åƒä¸‡çº§åˆ«çš„æœåŠ¡åç«¯")
    
    - 4.5w
    - 577
    - 166
    
- [ikoala](https://juejin.cn/user/430664257636407)
    
    11æœˆå‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [JavaScript](https://juejin.cn/tag/JavaScript) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [å­¦å®Œè¿™ç¯‡ Nest.js å®æˆ˜ï¼Œè¿˜æ²¡å…¥é—¨çš„æ¥é”¤æˆ‘ï¼(é•¿æ–‡é¢„è­¦)](https://juejin.cn/post/7032079740982788132 "å­¦å®Œè¿™ç¯‡ Nest.js å®æˆ˜ï¼Œè¿˜æ²¡å…¥é—¨çš„æ¥é”¤æˆ‘ï¼(é•¿æ–‡é¢„è­¦)")
    
    - 3.4w
    - 742
    - 120
    
- [YaHuiLiang](https://juejin.cn/user/4037062426369912)
    
    2å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js)
    
    [Koaè¿˜æ˜¯é‚£ä¸ªKoaï¼Œä½†æ˜¯Nodejså·²ç»ä¸å†æ˜¯é‚£ä¸ªNodejs](https://juejin.cn/post/6844904001578729485 "Koaè¿˜æ˜¯é‚£ä¸ªKoaï¼Œä½†æ˜¯Nodejså·²ç»ä¸å†æ˜¯é‚£ä¸ªNodejs")
    
    - 2.5w
    - 80
    - 60
    
- [çº¸ä¸Šçš„å½©è™¹](https://juejin.cn/user/1987553160857261)
    
    8æœˆå‰
    
    [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [æµè§ˆå™¨](https://juejin.cn/tag/%E6%B5%8F%E8%A7%88%E5%99%A8)
    
    [æ·±å…¥æµè§ˆå™¨ä¹‹æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹](https://juejin.cn/post/7064499913115041806 "æ·±å…¥æµè§ˆå™¨ä¹‹æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹")
    
    - 1322
    - 21
    - 9
    
- [æ¨æˆåŠŸ](https://juejin.cn/user/1169536100339101)
    
    11æœˆå‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [WebSocket](https://juejin.cn/tag/WebSocket) [ç½‘ç»œåè®®](https://juejin.cn/tag/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE)
    
    [å‰ç«¯æ¶æ„å¸ˆç ´å±€æŠ€èƒ½ï¼ŒNodeJS è½åœ° WebSocket å®è·µ](https://juejin.cn/post/7038491693997359117 "å‰ç«¯æ¶æ„å¸ˆç ´å±€æŠ€èƒ½ï¼ŒNodeJS è½åœ° WebSocket å®è·µ")
    
    - 1.6w
    - 243
    - 21
    
- [ç‹‚å¥”æ»´å°é©¬](https://juejin.cn/user/2189882895384093)
    
    7æœˆå‰
    
    [Node.js](https://juejin.cn/tag/Node.js)
    
    [æˆ‘ç”¨ nodejs çˆ¬äº†ä¸€ä¸‡å¤šå¼ å°å§å§å£çº¸](https://juejin.cn/post/7078206989402112037 "æˆ‘ç”¨ nodejs çˆ¬äº†ä¸€ä¸‡å¤šå¼ å°å§å§å£çº¸")
    
    - 6.6w
    - 704
    - 195
    
- [iwhao](https://juejin.cn/user/3122268755206334)
    
    1å¹´å‰
    
    [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [Node.js](https://juejin.cn/tag/Node.js)
    
    [ç»™å¥³å‹å†™çš„ï¼Œæ¯æ—¥è‡ªåŠ¨æ¨é€æš–å¿ƒæ¶ˆæ¯](https://juejin.cn/post/7012171027790692388 "ç»™å¥³å‹å†™çš„ï¼Œæ¯æ—¥è‡ªåŠ¨æ¨é€æš–å¿ƒæ¶ˆæ¯")
    
    - 2.1w
    - 395
    - 178
    
- [ç¨‹åºåª›æææææè•¾](https://juejin.cn/user/641770523211533)
    
    2æœˆå‰
    
    [JavaScript](https://juejin.cn/tag/JavaScript) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [Node.js](https://juejin.cn/tag/Node.js)
    
    [æœ€è¿‘çš„ Evil.js è®©æˆ‘æ˜ç™½äº†å¾ˆå¤š...](https://juejin.cn/post/7134524897291665421 "æœ€è¿‘çš„ Evil.js è®©æˆ‘æ˜ç™½äº†å¾ˆå¤š...")
    
    - 3.8w
    - 124
    - 109
    
- [Chriså¨](https://juejin.cn/user/3790771820967406)
    
    5å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [JavaScript](https://juejin.cn/tag/JavaScript) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [JSä¸­çš„ç®—æ³•ä¸æ•°æ®ç»“æ„â€”â€”é“¾è¡¨(Linked-list)](https://juejin.cn/post/6844903498362912775 "JSä¸­çš„ç®—æ³•ä¸æ•°æ®ç»“æ„â€”â€”é“¾è¡¨(Linked-list)")
    
    - 2.3w
    - 191
    - 24
    
- [æ²å](https://juejin.cn/user/3368559359825448)
    
    1å¹´å‰
    
    [æµè§ˆå™¨](https://juejin.cn/tag/%E6%B5%8F%E8%A7%88%E5%99%A8) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [æ·±å…¥ç†è§£æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹](https://juejin.cn/post/6991849728493256741 "æ·±å…¥ç†è§£æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹")
    
    - 5737
    - 159
    - 5
    
- [å­Ÿç¥¥_æˆéƒ½](https://juejin.cn/user/96412752684744)
    
    3å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js)
    
    [NodeJSæœ‰éš¾åº¦çš„é¢è¯•é¢˜ï¼Œä½ èƒ½ç­”å¯¹å‡ ä¸ªï¼Ÿ](https://juejin.cn/post/6844903951742025736 "NodeJSæœ‰éš¾åº¦çš„é¢è¯•é¢˜ï¼Œä½ èƒ½ç­”å¯¹å‡ ä¸ªï¼Ÿ")
    
    - 3.5w
    - 637
    - 26
    
- [ç¨‹åºå‘˜ä¾æ‰¬](https://juejin.cn/user/3720403075993373)
    
    3å¹´å‰
    
    [é¢è¯•](https://juejin.cn/tag/%E9%9D%A2%E8%AF%95) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [ã€1 æœˆæœ€æ–°ã€‘å‰ç«¯ 100 é—®ï¼šèƒ½ææ‡‚ 80% çš„è¯·æŠŠç®€å†ç»™æˆ‘](https://juejin.cn/post/6844903885488783374 "ã€1 æœˆæœ€æ–°ã€‘å‰ç«¯ 100 é—®ï¼šèƒ½ææ‡‚ 80% çš„è¯·æŠŠç®€å†ç»™æˆ‘")
    
    - 59.2w
    - 10313
    - 353
    
- [zxg_ç¥è¯´è¦æœ‰å…‰](https://juejin.cn/user/2788017216685118)
    
    1å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [Electron + Puppeteer + Robotjs å®ç°å·¥ä½œè‡ªåŠ¨åŒ–](https://juejin.cn/post/6957601771694850062 "Electron + Puppeteer + Robotjs å®ç°å·¥ä½œè‡ªåŠ¨åŒ–")
    
    - 1.6w
    - 300
    - 34
    
- [é‡‘è™¹æ¡¥ç¨‹åºå‘˜](https://juejin.cn/user/3579665589472200)
    
    9æœˆå‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [JavaScript](https://juejin.cn/tag/JavaScript)
    
    [éƒ½2022å¹´äº†ï¼Œpnpmå¿«åˆ°ç¢—é‡Œæ¥ï¼](https://juejin.cn/post/7053340250210795557 "éƒ½2022å¹´äº†ï¼Œpnpmå¿«åˆ°ç¢—é‡Œæ¥ï¼")
    
    - 3.1w
    - 419
    - 92
    
- [shawnchenxmu](https://juejin.cn/user/1063982985654685)
    
    4å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js)
    
    [NodeJS çš„é€‚ç”¨åœºæ™¯](https://juejin.cn/post/6844903641468387342 "NodeJS çš„é€‚ç”¨åœºæ™¯")
    
    - 8313
    - 138
    - 4
    
- [windlany](https://juejin.cn/user/3685218706275272)
    
    4å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [Express](https://juejin.cn/tag/Express)
    
    [é›¶åŸºç¡€å®ç°node+expressä¸ªæ€§åŒ–èŠå¤©å®¤](https://juejin.cn/post/6844903558848970760 "é›¶åŸºç¡€å®ç°node+expressä¸ªæ€§åŒ–èŠå¤©å®¤")
    
    - 1.2w
    - 512
    - 10
    
- [Alone381](https://juejin.cn/user/1679709496674295)
    
    4å¹´å‰
    
    [Node.js](https://juejin.cn/tag/Node.js) [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF)
    
    [å‰ç«¯çš„ç„¦è™‘ï¼Œä½ æƒ³è¿‡30å²ä»¥åçš„å‰ç«¯è·¯æ€ä¹ˆèµ°å—ï¼Ÿ](https://juejin.cn/post/6844903615681806344 "å‰ç«¯çš„ç„¦è™‘ï¼Œä½ æƒ³è¿‡30å²ä»¥åçš„å‰ç«¯è·¯æ€ä¹ˆèµ°å—ï¼Ÿ")
    
    - 4.8w
    - 670
    - 382
    
- [coder2028](https://juejin.cn/user/3791583997859512)
    
    28å¤©å‰
    
    [Node.js](https://juejin.cn/tag/Node.js)
    
    [ç†è§£NodeJSå¤šè¿›ç¨‹](https://juejin.cn/post/7152857274652835848 "ç†è§£NodeJSå¤šè¿›ç¨‹")
    
    - 453
    - 4
    - 1
    
- [æ¨ç¼ç’](https://juejin.cn/user/905653309146973)
    
    4å¹´å‰
    
    [å‰ç«¯](https://juejin.cn/tag/%E5%89%8D%E7%AB%AF) [Chrome](https://juejin.cn/tag/Chrome) [Google](https://juejin.cn/tag/Google)
    
    [å¤§å‰ç«¯ç¥å™¨å®‰åˆ©ä¹‹ Puppeteer](https://juejin.cn/post/6844903538204606471 "å¤§å‰ç«¯ç¥å™¨å®‰åˆ©ä¹‹ Puppeteer")
    
    - 3.9w
    - 684
    - 17
    
- [æ®·è£æ¡§](https://juejin.cn/user/1151943915355742)
    
    3å¹´å‰
    
    [React.js](https://juejin.cn/tag/React.js) [Node.js](https://juejin.cn/tag/Node.js) [Vue.js](https://juejin.cn/tag/Vue.js)
    
    [çœ‹çœ‹è¿™äº›è¢«åŒäº‹å–·çš„JSä»£ç é£æ ¼ä½ å†™è¿‡å¤šå°‘](https://juejin.cn/post/6844903714164047879 "çœ‹çœ‹è¿™äº›è¢«åŒäº‹å–·çš„JSä»£ç é£æ ¼ä½ å†™è¿‡å¤šå°‘")
    
    - 5.6w
    - 1097
    - 206
    

å‹æƒ…é“¾æ¥ï¼š

- [æ ‡è‡´508L PHEV](https://www.dongchedi.com/auto/series/3473 "æ ‡è‡´508L PHEV")
- [å¥”è…¾T99](https://www.dongchedi.com/auto/series/3474 "å¥”è…¾T99")
- [ä¸Šæ±½å¤§é€šMAXUS T70](https://www.dongchedi.com/auto/series/3475 "ä¸Šæ±½å¤§é€šMAXUS T70")
- [æ˜Ÿç‘](https://www.dongchedi.com/auto/series/3476 "æ˜Ÿç‘")
- [Auris](https://www.dongchedi.com/auto/series/2170 "Auris")
- [ç»´ç‰¹æ‹‰(æµ·å¤–)](https://www.dongchedi.com/auto/series/2221 "ç»´ç‰¹æ‹‰(æµ·å¤–)")
- [Figo](https://www.dongchedi.com/auto/series/2604 "Figo")
- [è²äºšç‰¹500X](https://www.dongchedi.com/auto/series/2606 "è²äºšç‰¹500X")
- [G-Code](https://www.dongchedi.com/auto/series/2607 "G-Code")
- [è²äºšç‰¹FCC4](https://www.dongchedi.com/auto/series/2608 "è²äºšç‰¹FCC4")

[<img width="48" height="48" src="../_resources/16d42ae0d6d59e39_tplv-t2oaga2asx_69fe8d08c55149158.webp"/>](https://juejin.cn/user/430664257636407)

[](https://juejin.cn/user/430664257636407)[ikoala <img width="35" height="16" src="../_resources/lv-6.b69935b_1221cd041a694ac0b64aaf1d8bd9a4ed.png"/>](https://juejin.cn/user/430664257636407) 

ä¼ªå…¨æ ˆ @ ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—

[ç§ä¿¡](https://juejin.cn/notification/im?participantId=430664257636407)

<img width="25" height="25" src="../_resources/3552fa95ef404b7585e9d3362d085e6b_84addca0705e4680a.png"/> 2021å¹´åº¦äººæ°”ä½œè€…No.61

è·å¾—ç‚¹èµ Â 13,127

æ–‡ç« è¢«é˜…è¯» Â 623,740

[<img width="50" height="50" src="../_resources/article.9d13ff7_7426d62b8c1d48f5bfd727aaeebc279d.png"/><br>ä¸‹è½½ç¨€åœŸæ˜é‡‘APP<br>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº](https://juejin.cn/app)

<img width="300" height="249" src="../_resources/default.640d9a7_973f9de1a0f24f4d9f00abded574b124.png"/>

ç›¸å…³æ–‡ç« 

[å­¦å®Œè¿™ç¯‡ Nest.js å®æˆ˜ï¼Œè¿˜æ²¡å…¥é—¨çš„æ¥é”¤æˆ‘ï¼(é•¿æ–‡é¢„è­¦)<br>742ç‚¹èµ<br>Â Â·Â <br>120è¯„è®º](https://juejin.cn/post/7032079740982788132 "å­¦å®Œè¿™ç¯‡ Nest.js å®æˆ˜ï¼Œè¿˜æ²¡å…¥é—¨çš„æ¥é”¤æˆ‘ï¼(é•¿æ–‡é¢„è­¦)")[Nest.js å®æˆ˜ç³»åˆ—äºŒ-æ‰‹æŠŠæ‰‹å¸¦ä½ -å®ç°æ³¨å†Œã€æ‰«ç ç™»å½•ã€jwtè®¤è¯ç­‰<br>173ç‚¹èµ<br>Â Â·Â <br>53è¯„è®º](https://juejin.cn/post/7044708915438682148 "Nest.js å®æˆ˜ç³»åˆ—äºŒ-æ‰‹æŠŠæ‰‹å¸¦ä½ -å®ç°æ³¨å†Œã€æ‰«ç ç™»å½•ã€jwtè®¤è¯ç­‰")[åŸºäºNest.js+TypeORMå®æˆ˜ç³»åˆ—3ï¼ˆé¡¹ç›®å·²å¼€æºï¼‰<br>80ç‚¹èµ<br>Â Â·Â <br>13è¯„è®º](https://juejin.cn/post/7142704416695517214 "åŸºäºNest.js+TypeORMå®æˆ˜ç³»åˆ—3ï¼ˆé¡¹ç›®å·²å¼€æºï¼‰")[Docker æ­å»ºä½ çš„ç¬¬ä¸€ä¸ª Node é¡¹ç›®åˆ°æœåŠ¡å™¨(å®Œæ•´ç‰ˆ)<br>646ç‚¹èµ<br>Â Â·Â <br>27è¯„è®º](https://juejin.cn/post/6844904035053486087 "Docker æ­å»ºä½ çš„ç¬¬ä¸€ä¸ª Node é¡¹ç›®åˆ°æœåŠ¡å™¨(å®Œæ•´ç‰ˆ)")[åˆ†äº« 10 é“ Nodejs è¿›ç¨‹ç›¸å…³é¢è¯•é¢˜<br>81ç‚¹èµ<br>Â Â·Â <br>2è¯„è®º](https://juejin.cn/post/6844903870066327566 "åˆ†äº« 10 é“ Nodejs è¿›ç¨‹ç›¸å…³é¢è¯•é¢˜")

ç›®å½•

- [å‰è¨€](#heading-0 "å‰è¨€")
    
- [æ–‡ç« å¯¼è§ˆ](#heading-1 "æ–‡ç« å¯¼è§ˆ")
    
- [é¢è¯•ä¼šé—®](#heading-2 "é¢è¯•ä¼šé—®")
    
- [è¿›ç¨‹](#heading-3 "è¿›ç¨‹")
    
- [çº¿ç¨‹](#heading-4 "çº¿ç¨‹")
    
    - [å•çº¿ç¨‹](#heading-5 "å•çº¿ç¨‹")
        
        - [ç»å…¸è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡çš„ä¾‹å­](#heading-6 "ç»å…¸è®¡ç®—è€—æ—¶é€ æˆçº¿ç¨‹é˜»å¡çš„ä¾‹å­")
            
        - [å•çº¿ç¨‹çš„ä¸€äº›è¯´æ˜](#heading-7 "å•çº¿ç¨‹çš„ä¸€äº›è¯´æ˜")
            
- [Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹](#heading-8 "Node.js ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹")
    
    - [Node.js ä¸­çš„è¿›ç¨‹](#heading-9 "Node.js ä¸­çš„è¿›ç¨‹")
        
        - [process æ¨¡å—](#heading-10 "process æ¨¡å—")
            
        - [Node.js è¿›ç¨‹åˆ›å»º](#heading-11 "Node.js è¿›ç¨‹åˆ›å»º")
            
        - [Node.jsè¿›ç¨‹é€šä¿¡åŸç†](#heading-17 "Node.jsè¿›ç¨‹é€šä¿¡åŸç†")
            
        - [Node.jså¥æŸ„ä¼ é€’](#heading-18 "Node.jså¥æŸ„ä¼ é€’")
            
        - [Node.jså¤šè¿›ç¨‹æ¶æ„æ¨¡å‹](#heading-21 "Node.jså¤šè¿›ç¨‹æ¶æ„æ¨¡å‹")
            
        - [Node.js è¿›ç¨‹å®ˆæŠ¤](#heading-22 "Node.js è¿›ç¨‹å®ˆæŠ¤")
            
        - [linux å…³é—­ä¸€ä¸ªè¿›ç¨‹](#heading-25 "linux å…³é—­ä¸€ä¸ªè¿›ç¨‹")
            
    - [Node.js çº¿ç¨‹](#heading-26 "Node.js çº¿ç¨‹")
        
        - [Node.jså…³äºå•çº¿ç¨‹çš„è¯¯åŒº](#heading-27 "Node.jså…³äºå•çº¿ç¨‹çš„è¯¯åŒº")
            
        - [æŸäº›å¼‚æ­¥ IO ä¼šå ç”¨é¢å¤–çš„çº¿ç¨‹](#heading-28 "æŸäº›å¼‚æ­¥ IO ä¼šå ç”¨é¢å¤–çš„çº¿ç¨‹")
            
        - [Node.js çº¿ç¨‹åˆ›å»º](#heading-30 "Node.js çº¿ç¨‹åˆ›å»º")
            
- [æ€»ç»“](#heading-32 "æ€»ç»“")